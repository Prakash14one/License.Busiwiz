using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.Text;
using System.Collections.Generic;
using System.Net;
using System.IO;
using System.Security.Cryptography.X509Certificates;
using System.Net.Security;
using ForAspNet.POP3;
using System.Runtime.InteropServices;
using System.Security.Cryptography;
using System.Data.SqlClient;
using System.Diagnostics;
using System.Text.RegularExpressions;
//using UtilitiesFTP.FTP;



public partial class QuickRetrivebyFTPandFolder : System.Web.UI.Page
{

    SqlConnection con;
    const int TRUE = 1;
    const int FALSE = 0;
    DocumentCls1 clsDocument = new DocumentCls1();
    MasterCls clsMaster;
    Companycls ClsCompany = new Companycls();
    protected int DesignationId;
    EmployeeCls clsEmployee = new EmployeeCls();
    protected void Page_Load(object sender, EventArgs e)
    {
        PageConn pgcon = new PageConn();
        con = pgcon.dynconn;
        pagetitleclass pg = new pagetitleclass();
        string strData = Request.Url.ToString();

        char[] separator = new char[] { '/' };

        string[] strSplitArr = strData.Split(separator);
        int i = Convert.ToInt32(strSplitArr.Length);
        string page = strSplitArr[i - 1].ToString();
        Session["PageUrl"] = strData;
        Session["PageName"] = page;
        Page.Title = pg.getPageTitle(page);

        if (Session["CompanyName"] != null)
        {
            this.Title = Session["CompanyName"] + " IFileCabinet.com - Auto Document Download  ";
        }

        Session["PageName"] = "Down.aspx";

        if (!Page.IsPostBack)
        {
            string str = "SELECT WareHouseId,Name,Address,CurrencyId  FROM WareHouseMaster where comid = '" + Session["comid"] + "'and WareHouseMaster.Status='" + 1 + "' order by name";

            SqlCommand cmd1 = new SqlCommand(str, con);
            cmd1.CommandType = CommandType.Text;
            SqlDataAdapter da = new SqlDataAdapter(cmd1);
            DataTable dte = new DataTable();
            da.Fill(dte);

            ddlbusiness.DataSource = dte;
            ddlbusiness.DataTextField = "Name";
            ddlbusiness.DataValueField = "WareHouseId";
            ddlbusiness.DataBind();

            DataTable dt = new DataTable();

            if (Request.QueryString["Id"] != null)
            {
                int id = Convert.ToInt32(Request.QueryString["Id"]);

                if (id == 1)
                {
                    RadioButtonList1.SelectedValue = "0";
                }
                if (id == 2)
                {
                    RadioButtonList1.SelectedValue = "1";
                }
                if (id == 3)
                {
                    RadioButtonList1.SelectedValue = "2";

                }


            }


            RadioButtonList1_SelectedIndexChanged(sender, e);
        }

    }
    public void FillFolderGrid()
    {
        lblhea.Text = "Select Server Folder Path to Download";
        DataTable dt = new DataTable();
        dt = ClsCompany.SelectDownloadFolder(ddlbusiness.SelectedValue);
        grdDesignation.DataSource = dt;
        grdDesignation.DataKeyNames = new string[] { "FolderId" };
        grdDesignation.Columns[2].Visible = false;
        grdDesignation.Columns[1].HeaderText = "Server Folder";
        grdDesignation.DataBind();
        fillret();

    }
    public void FillFtpGrid()
    {
        lblhea.Text = "Select FTP Account Path to Download";
        DataTable dt = new DataTable();
        dt = clsDocument.SelectFtpMaster(ddlbusiness.SelectedValue);
        grdDesignation.DataSource = dt;
        grdDesignation.DataKeyNames = new string[] { "FtpId" };
        grdDesignation.Columns[1].HeaderText = "FTP Account";
        grdDesignation.Columns[2].HeaderText = "User Name";
        grdDesignation.Columns[2].Visible = true;
        grdDesignation.DataBind();
        fillret();

    }
    public void FillEmailGrid()
    {
        lblhea.Text = "Select Email Account Path to Download";
        DataTable dt = new DataTable();
        dt = clsDocument.SelectDocumentEmailDownloadMaster(ddlbusiness.SelectedValue);
        grdDesignation.DataSource = dt;
        grdDesignation.DataKeyNames = new string[] { "DocumentEmailDownloadID" };
        grdDesignation.Columns[1].HeaderText = "Email Account";
        grdDesignation.Columns[2].HeaderText = "Server Name";
        grdDesignation.Columns[2].Visible = true;
        grdDesignation.DataBind();
        fillret();

    }

    protected void imgbShowEmp_Click(object sender, EventArgs e)
    {
        if (RadioButtonList1.SelectedValue == "0")
        {
            MoveFromFTP();
        }
        else if (RadioButtonList1.SelectedValue == "1")
        {
            MoveFromMail();
        }
        else if (RadioButtonList1.SelectedValue == "2")
        {
            MoveFromFolder();
        }


    }
    protected void accbalentry()
    {

        DataTable ds153 = new DataTable();
        ds153 = select("select Report_Period_Id  from ReportPeriod where Compid='" + Session["Comid"].ToString() + "' and Whid='" + ddlbusiness.SelectedValue + "' and Active='1'");
        Session["reportid"] = ds153.Rows[0]["Report_Period_Id"].ToString();

        DataTable ds1531 = new DataTable();
        ds1531 = select("select Report_Period_Id from [ReportPeriod] where ReportPeriod.Report_Period_Id<'" + Session["reportid"] + "' and  Whid='" + ddlbusiness.SelectedValue + "'  order by Report_Period_Id Desc");
        Session["reportid1"] = ds1531.Rows[0]["Report_Period_Id"].ToString();

        string str4562 = "insert into AccountBalance(AccountMasterId,Balance,Report_Period_Id) values ('" + Session["maxaid"].ToString() + "','" + 0 + "','" + Session["reportid1"] + "')";
        SqlCommand cmd4562 = new SqlCommand(str4562, con);
        con.Open();
        cmd4562.ExecuteNonQuery();
        con.Close();


        string str456 = "insert into AccountBalance(AccountMasterId,Balance,Report_Period_Id) values ('" + Session["maxaid"].ToString() + "','" + 0 + "','" + Session["reportid"].ToString() + "')";
        SqlCommand cmd456 = new SqlCommand(str456, con);
        con.Open();
        cmd456.ExecuteNonQuery();
        con.Close();

    }
    protected int UserEntry()
    {
        DataTable dtt = new DataTable();
        string accid = "";
        dtt = (DataTable)select("Select Max(AccountId) as aid from AccountMaster where GroupId='15' and  Whid='" + ddlbusiness.SelectedValue + "'");
        if (dtt.Rows.Count > 0)
        {
            if (dtt.Rows[0]["aid"].ToString() != "")
            {
                //if(Convert.ToInt32(dtt.Rows[0]["aid"].ToString() >  )
                //{

                //}
                int gid = Convert.ToInt32(dtt.Rows[0]["aid"].ToString()) + 1;
                accid = Convert.ToString(gid);
            }
            else
            {
                accid = Convert.ToString(30000);
            }
        }
        int prttypeid = 0;


        DataTable dtminprt100 = new DataTable();
        dtminprt100 = clsDocument.SelectOtherPartyTypeId("Admin");

        if (dtminprt100.Rows.Count > 0)
        {
            if (dtminprt100.Rows[0]["PartyTypeId"] != System.DBNull.Value)
            {
                prttypeid = Convert.ToInt32(dtminprt100.Rows[0]["PartyTypeId"].ToString());

            }
        }
        SqlCommand cmddept = new SqlCommand("Select id from DepartmentmasterMNC where Whid='" + ddlbusiness.SelectedValue + "'", con);
        con.Open();
        object dept = cmddept.ExecuteScalar();
        con.Close();

        SqlCommand cmddesig = new SqlCommand("Select DesignationMasterId from DesignationMaster where DeptID='" + dept.ToString() + "'", con);
        con.Open();
        object desig = cmddesig.ExecuteScalar();
        con.Close();
        EmployeeCls clsEmployee = new EmployeeCls();
        Int32 AccountId = clsMaster.InsertAccountMasterParty(accid, 5, 15, "test", System.DateTime.Today.ToShortDateString(), ddlbusiness.SelectedValue);
        Session["maxaid"] = AccountId.ToString();
        accbalentry();
        Int32 partyid = clsMaster.InsertPartyMasterMess(prttypeid, AccountId, "Capman", "Na", "Capman", "0", "0", "0", "epaza.us", "", ddlbusiness.SelectedValue);
        string ins6 = "insert into User_master(Name,Address ,City,State,Country,Phoneno,EmailID ,Username,Department,Accesslevel,PartyID,DesigantionMasterId,Active,Extention,zipcode)" +
                                       "values ('WellCapman','WellCapman','0','0','0','0','','Capman','" + dept + "','1','" + partyid + "','" + desig + "','True','0','0')";
        SqlCommand cmd6 = new SqlCommand(ins6, con);
        if (con.State.ToString() != "Open")
        {
            con.Open();
        }
        cmd6.ExecuteNonQuery();

        con.Close();
        DataTable datUser = new DataTable();
        datUser = select("select max(UserID) as UserID from User_master where PartyID='" + partyid + "' ");
        if (datUser.Rows.Count > 0)
        {
            string ins7 = "insert into Login_master(UserID,username,password,department,accesslevel,deptid,accessid) values ('" + Convert.ToInt32(datUser.Rows[0]["UserID"]) + "','Capman','Capman','0','1','0','1')";
            SqlCommand cmd9 = new SqlCommand(ins7, con);
            if (con.State.ToString() != "Open")
            {
                con.Open();
            }
            cmd9.ExecuteNonQuery();
            con.Close();

            string stremp = "Insert into EmployeeMaster(PartyID,DeptID,DesignationMasterId,StatusMasterId,EmployeeTypeId, " +
            " Address,CountryId,StateId,City,ContactNo,Email,AccountId,AccountNo,EmployeeName,Whid,Description) values('" + partyid + "','" + dept + "', " +
            " '" + desig + "','0','0','Capman', " +
                " '0','0','0','5675','','" + AccountId + "','" + AccountId + "','Capman','" + ddlbusiness.SelectedValue + "','Capman')";
            SqlCommand cmdemp = new SqlCommand(stremp, con);
            con.Open();
            cmdemp.ExecuteNonQuery();
            con.Close();



            string userid = datUser.Rows[0]["UserID"].ToString();

            SqlCommand cmd45 = new SqlCommand("Insert into Login_master(UserID,username,password,department,accesslevel,deptid,accessid) values ('" + userid + "','0','000','" + dept.ToString() + "','1','3','1')", con);
            con.Open();
            cmd45.ExecuteNonQuery();
            con.Close();
            string str3 = "select Role_id from RoleMaster where Role_name='Admin' and compid='" + Session["comid"] + "' ";
            SqlCommand cmd34 = new SqlCommand(str3, con);
            SqlDataAdapter adp12 = new SqlDataAdapter(cmd34);
            DataTable dtlogin12 = new DataTable();
            adp12.Fill(dtlogin12);

            if (dtlogin12.Rows.Count > 0)
            {
                string roleid = dtlogin12.Rows[0]["Role_id"].ToString();


                SqlCommand cmd8 = new SqlCommand("Insert into User_Role (User_id,Role_id,ActiveDeactive) values ('" + userid + "','" + roleid + "','true ')", con);
                con.Open();
                cmd8.ExecuteNonQuery();
                con.Close();

            }



        }

        return partyid;

    }
    public void MoveFromFolder()
    {
        int Flaggg = 0;
        int i;
        i = 0;
        bool insdata;
        insdata = false;
        try
        {
            string location = Server.MapPath("~//Account//" + Session["comid"] + "//UploadedDocuments//");
            string location1 = Server.MapPath("~//Account//" + Session["comid"] + "//UploadedDocumentsTemp//");
            DataTable dt = new DataTable();
            dt = ClsCompany.selectCompanyMaster();
            if (Convert.ToString(dt.Rows[0]["DocFolder"]) == "True")
            {
                bool chked = false;
                if (grdDesignation.Rows.Count > 0)
                {
                    do
                    {
                        CheckBox chkdegs = (CheckBox)grdDesignation.Rows[i].FindControl("chkDesignation");

                        if (chkdegs.Checked == true)
                        {
                            chked = true;
                            insdata = true;
                            Int32 FolderId;
                            FolderId = Convert.ToInt32(grdDesignation.DataKeys[i].Value.ToString());
                            clsMaster = new MasterCls();
                            dt = new DataTable();
                            dt = clsDocument.SelectDownloadFolderIdwise(FolderId);
                            DataTable dtt = new DataTable();
                            if (dt.Rows.Count > 0)
                            {
                               
                                try
                                {

                                string FolderPath = ""; //barodaoffice/port huron document"
                                // W:/websites/Capman.ifilecabinet 16-June-09/Capman.ifilecabinet_new/Account
                                string strpath = dt.Rows[0]["FolderName"].ToString();
                                string[] starr2 = strpath.Split('\\');

                                string drv = starr2[0].ToString();
                                string fldmn = starr2[1].ToString();

                                FolderPath = FolderPath + dt.Rows[0]["FolderName"].ToString();
                                FolderPath = FolderPath + @"\";
                                System.IO.DirectoryInfo dir = new System.IO.DirectoryInfo(FolderPath);
                                foreach (System.IO.FileInfo f in dir.GetFiles("*.pdf"))
                                {
                                    //Response.Write(f.Name.ToString());
                                    location = Server.MapPath("~//Account//" + Session["comid"] + "//UploadedDocuments//");
                                    location1 = Server.MapPath("~//Account//" + Session["comid"] + "//UploadedDocumentsTemp//");
                                    //string Location_Doc = @"\\192.168.6.49\";
                                    
                                    if (System.IO.File.GetAttributes(FolderPath + f.Name).ToString() != System.IO.FileAttributes.Hidden.ToString())
                                    {

                                        if (System.IO.File.Exists(location + f.Name))
                                        {
                                        }
                                        else
                                        {
                                            System.IO.File.Copy(FolderPath + f.Name, location + f.Name);
                                        }
                                        string flexnt = Path.GetExtension(location + f.Name);
                                        if (flexnt == ".pdf")
                                        {
                                            string filepath = Server.MapPath("~//Account//pdftoimage.exe");
                                            System.Diagnostics.ProcessStartInfo pti = new System.Diagnostics.ProcessStartInfo(filepath);
                                            
                                            pti.UseShellExecute = false;
                                            //pti.Arguments = "@"+Server.MapPath("~//Account//") + "pdftoimage -i UploadedDocuments//" + f.Name + " " + "-o" + " " + "DocumentImage//";
                                            pti.Arguments = filepath + " -i UploadedDocuments//" + f.Name + " " + "-o" + " " + "DocumentImage//";

                                            pti.RedirectStandardOutput = true;
                                            pti.RedirectStandardInput = true;
                                            pti.RedirectStandardError = true;
                                            //pti.WorkingDirectory = "D:\\Capman.ifilecabinet.com1\\Account\\";
                                            pti.WorkingDirectory = Server.MapPath("~//Account//" + Session["comid"] + "//");
                                            System.Diagnostics.Process ps = Process.Start(pti);
                                        }

                                        string sPdfFile = FolderPath + f.Name;
                                        string sOutDir = location + f.Name;
                                        string sOutDir1 = location1 + f.Name;
                                        string filename1 = f.Name;
                                        Int32 DocId;
                                        DocId = 0;
                                      
                                        string frtstr = "";
                                        string extstr = "";
                                        string whlstr = "";
                                        char[] separator1 = new char[] { '.' };
                                        string[] strSplitArr1 = f.Name.Split(separator1);
                                        int i111 = Convert.ToInt32(strSplitArr1.Length);
                                        if (i111 == 2)
                                        {
                                            whlstr = strSplitArr1[0].ToString();
                                            extstr = strSplitArr1[1].ToString();
                                        }
                                        else if (i111 == 3)
                                        {
                                            string[] starr1 = f.Name.Split('.');

                                            string fst = starr1[0].ToString();
                                            string sncd = starr1[1].ToString();
                                            extstr = starr1[2].ToString();
                                            whlstr = fst + "." + sncd;
                                        }
                                        string lnstr = "";
                                        string mainstr = "";
                                        string srchamt = "amt";
                                        string srchref = "ref";
                                        string srchdt = "dt";
                                        string srchprt = "party";
                                        string srchfld = "folder";
                                        int amtindx = 0;
                                        int refindx = 0;
                                        int dtindx = 0;
                                        int prtindx = 0;
                                        int fldindx = 0;
                                        Double amt = 0.0;
                                        string refst = "";
                                        string dat = "";
                                        string party = "";
                                        string folder = "";
                                        char[] separator = new char[] { '-' };
                                        string Docnam = "";
                                        Int32 folderid = 0;
                                      
                                        Int32 prtid = 0;
                                       
                                        Int32 i34 = 0;
                                        Int32 ign = 0;
                                        if (whlstr == "")
                                        {
                                            lnstr = filename1;
                                        }
                                        else if (whlstr != "")
                                        {
                                            lnstr = whlstr;
                                        }
                                       

                                        fldindx = lnstr.IndexOf(srchfld);
                                        dtindx = lnstr.IndexOf(srchdt);
                                        amtindx = lnstr.IndexOf(srchamt);
                                        refindx = lnstr.IndexOf(srchref);
                                        prtindx = lnstr.IndexOf(srchprt);
                                        if (amtindx < 0)
                                        {
                                            string srch2amt = "AMT";
                                            amtindx = lnstr.IndexOf(srch2amt);
                                        }
                                        if (refindx < 0)
                                        {
                                            string srch2ref = "REF";
                                            refindx = lnstr.IndexOf(srch2ref);
                                        }
                                        if (dtindx < 0)
                                        {
                                            string srch2dt = "DT";
                                            dtindx = lnstr.IndexOf(srch2dt);
                                        }
                                        if (prtindx < 0)
                                        {
                                            string srch2prt = "PARTY";
                                            prtindx = lnstr.IndexOf(srch2prt);
                                        }
                                        if (fldindx < 0)
                                        {
                                            string srch2fld = "FOLDER";
                                            fldindx = lnstr.IndexOf(srch2fld);
                                        }
                                        if (amtindx < 0)
                                        {
                                            string srch3amt = "Amt";
                                            amtindx = lnstr.IndexOf(srch3amt);
                                        }
                                        if (refindx < 0)
                                        {
                                            string srch3ref = "Ref";
                                            refindx = lnstr.IndexOf(srch3ref);
                                        }
                                        if (dtindx < 0)
                                        {
                                            string srch3dt = "Dt";
                                            dtindx = lnstr.IndexOf(srch3dt);
                                        }
                                        if (prtindx < 0)
                                        {
                                            string srch3prt = "Party";
                                            prtindx = lnstr.IndexOf(srch3prt);
                                        }
                                        if (fldindx < 0)
                                        {
                                            string srch3fld = "Folder";
                                            fldindx = lnstr.IndexOf(srch3fld);
                                        }
                                        if (fldindx < 0)
                                        {
                                            string srch4fld = "flder";
                                            fldindx = lnstr.IndexOf(srch4fld);
                                        }
                                        if (prtindx < 0)
                                        {
                                            string srch4prt = "prty";
                                            prtindx = lnstr.IndexOf(srch4prt);
                                        }
                                        if (prtindx < 0)
                                        {
                                            string srch5prt = "Prty";
                                            prtindx = lnstr.IndexOf(srch5prt);
                                        }
                                        int amtin1 = amtindx + 4;
                                        int refin1 = refindx + 4;
                                        int dtin1 = dtindx + 3;
                                        int prtin1 = prtindx + 6;
                                        int fldin1 = fldindx + 7;
                                        if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (amtindx < refindx && refindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < fldindx && fldindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < refindx && refindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < dtindx && dtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < refindx && refindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < prtindx && prtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < amtindx && amtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < fldindx && fldindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < amtindx && amtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < amtindx && amtindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < amtindx && amtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < refindx && refindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < amtindx && amtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < refindx && refindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < prtindx && prtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < amtindx && amtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < refindx && refindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < amtindx && amtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < refindx && refindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < dtindx && dtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < refindx && refindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < refindx && refindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < dtindx && dtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < prtindx && prtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < amtindx && amtindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < refindx && refindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < amtindx && amtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < refindx && refindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < prtindx && prtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < refindx && refindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < amtindx && amtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < refindx && refindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < dtindx && dtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx < 0)
                                        {
                                            if (amtindx < refindx && refindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (amtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                        }
                                        if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (amtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                string[] strSplitArr = folder.Split(separator);

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (amtindx < fldindx && fldindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (fldindx < refindx && refindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        else if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0 && fldindx < 0)
                                        {
                                            if (amtindx < refindx)
                                            {
                                                if (amtindx < dtindx)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > dtindx)
                                                {
                                                    int diffamt = refindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    int ttldat = amtindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > refindx)
                                            {
                                                if (amtindx < dtindx)
                                                {
                                                    int diffamt = dtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, amtindx - refin1);
                                                    string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (amtindx > dtindx)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        refst = lnstr.Substring(refin1, dtindx - refin1);
                                                        int ttldat = amtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx >= 0 && fldindx < 0)
                                        {
                                            if (amtindx < refindx)
                                            {
                                                if (amtindx < prtindx)
                                                {
                                                    if (refindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx > prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > prtindx)
                                                {
                                                    int diffamt = refindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > refindx)
                                            {
                                                if (amtindx < prtindx)
                                                {
                                                    int diffamt = prtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, amtindx - refin1);
                                                    party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (amtindx > prtindx)
                                                {
                                                    if (refindx < prtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        refst = lnstr.Substring(refin1, prtindx - refin1);
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > prtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx >= 0 && fldindx < 0)
                                        {
                                            if (amtindx < dtindx)
                                            {
                                                if (amtindx < prtindx)
                                                {
                                                    if (dtindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else if (dtindx > prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        int ttldat = lnstr.Length - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }

                                                }
                                                else if (amtindx > prtindx)
                                                {
                                                    int diffamt = dtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    int ttldat = lnstr.Length - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > dtindx)
                                            {
                                                if (amtindx < prtindx)
                                                {
                                                    int diffamt = prtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    int ttldat = amtindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                    mainstr = lnstr.Remove(dtindx).Trim();
                                                }
                                                else if (amtindx > prtindx)
                                                {
                                                    if (dtindx < prtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx > prtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx < 0)
                                        {
                                            if (refindx < dtindx)
                                            {
                                                if (refindx < prtindx)
                                                {
                                                    if (dtindx < prtindx)
                                                    {
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else if (dtindx > prtindx)
                                                    {

                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        int ttldat = lnstr.Length - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                }
                                                else if (refindx > prtindx)
                                                {

                                                    int ttlref = dtindx - refin1;
                                                    if (ttlref > 10)
                                                    {
                                                        ttlref = 10;
                                                    }
                                                    refst = lnstr.Substring(refin1, ttlref);
                                                    int ttldat = lnstr.Length - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                    mainstr = lnstr.Remove(prtindx).Trim();
                                                }
                                            }
                                            else if (refindx > dtindx)
                                            {
                                                if (refindx < prtindx)
                                                {

                                                    int ttlref = prtindx - refin1;
                                                    if (ttlref > 10)
                                                    {
                                                        ttlref = 10;
                                                    }
                                                    refst = lnstr.Substring(refin1, ttlref);
                                                    int ttldat = refindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                    mainstr = lnstr.Remove(dtindx).Trim();
                                                }
                                                else if (refindx > prtindx)
                                                {
                                                    if (dtindx < prtindx)
                                                    {

                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();


                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx > prtindx)
                                                    {
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                            }


                                        }
                                        else if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (amtindx < refindx)
                                            {
                                                if (amtindx < fldindx)
                                                {
                                                    if (refindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        //dat = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx > fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = refindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        //dat = lnstr.Substring(fldin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > fldindx)
                                                {
                                                    int diffamt = refindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    int ttldat = amtindx - fldin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    folder = lnstr.Substring(fldin1, ttldat).Trim();


                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > refindx)
                                            {
                                                if (amtindx < fldindx)
                                                {
                                                    int diffamt = fldindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, amtindx - refin1);
                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();


                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (amtindx > fldindx)
                                                {
                                                    if (refindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        refst = lnstr.Substring(refin1, fldindx - refin1);
                                                        int ttldat = amtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();


                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (amtindx < fldindx)
                                            {
                                                if (amtindx < dtindx)
                                                {
                                                    if (fldindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (fldindx > dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > dtindx)
                                                {
                                                    int diffamt = fldindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);
                                                    int ttldat = amtindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > fldindx)
                                            {
                                                if (amtindx < dtindx)
                                                {
                                                    int diffamt = dtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    folder = lnstr.Substring(fldin1, amtindx - fldin1);
                                                    string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(fldindx).Trim();
                                                }
                                                else if (amtindx > dtindx)
                                                {
                                                    if (fldindx < dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1);
                                                        int ttldat = amtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx > dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (fldindx < refindx)
                                            {
                                                if (fldindx < dtindx)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        int diffamt = refindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        int diffamt = dtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                                else if (fldindx > dtindx)
                                                {
                                                    int diffamt = refindx - fldin1;
                                                    folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    int ttldat = fldindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(fldindx).Trim();
                                                }
                                            }
                                            else if (fldindx > refindx)
                                            {
                                                if (fldindx < dtindx)
                                                {
                                                    int diffamt = dtindx - fldin1;
                                                    folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                    refst = lnstr.Substring(refin1, fldindx - refin1);
                                                    string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (fldindx > dtindx)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                        refst = lnstr.Substring(refin1, dtindx - refin1);
                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        string string1 = folder;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                }
                                            }
                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (amtindx < prtindx)
                                            {
                                                if (amtindx < fldindx)
                                                {
                                                    if (prtindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - prtin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        party = lnstr.Substring(prtin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        //dat = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (prtindx > fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = prtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        //dat = lnstr.Substring(fldin1, ttldat).Trim();
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > fldindx)
                                                {
                                                    int diffamt = prtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    party = lnstr.Substring(prtin1, lnstr.Length - prtin1);
                                                    int ttldat = amtindx - fldin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > prtindx)
                                            {
                                                if (amtindx < fldindx)
                                                {
                                                    int diffamt = fldindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    party = lnstr.Substring(prtin1, amtindx - prtin1);
                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                    mainstr = lnstr.Remove(prtindx).Trim();
                                                }
                                                else if (amtindx > fldindx)
                                                {
                                                    if (prtindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1);
                                                        int ttldat = amtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx > fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - prtin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        party = lnstr.Substring(prtin1, ttlref);
                                                        int ttldat = prtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                            }
                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (prtindx < refindx)
                                            {
                                                if (prtindx < fldindx)
                                                {
                                                    if (refindx < fldindx)
                                                    {
                                                        int diffamt = refindx - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        //dat = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (refindx > fldindx)
                                                    {
                                                        int diffamt = fldindx - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttldat = refindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        //dat = lnstr.Substring(fldin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                else if (prtindx > fldindx)
                                                {
                                                    int diffamt = refindx - prtin1;
                                                    party = lnstr.Substring(prtin1, diffamt).Trim();

                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    int ttldat = prtindx - fldin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                    mainstr = lnstr.Remove(prtindx).Trim();
                                                }
                                            }
                                            else if (prtindx > refindx)
                                            {
                                                if (prtindx < fldindx)
                                                {
                                                    int diffamt = fldindx - prtin1;
                                                    party = lnstr.Substring(prtin1, diffamt).Trim();

                                                    refst = lnstr.Substring(refin1, prtindx - refin1);
                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();


                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (prtindx > fldindx)
                                                {
                                                    if (refindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        refst = lnstr.Substring(refin1, fldindx - refin1);
                                                        int ttldat = prtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();


                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                            }
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (prtindx < fldindx)
                                            {
                                                if (prtindx < dtindx)
                                                {
                                                    if (fldindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx > dtindx)
                                                    {
                                                        int diffamt = dtindx - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                else if (prtindx > dtindx)
                                                {
                                                    int diffamt = fldindx - prtin1;
                                                    party = lnstr.Substring(prtin1, diffamt).Trim();

                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);
                                                    int ttldat = prtindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(prtindx).Trim();
                                                }
                                            }
                                            else if (prtindx > fldindx)
                                            {
                                                if (prtindx < dtindx)
                                                {
                                                    int diffamt = dtindx - prtin1;
                                                    party = lnstr.Substring(prtin1, diffamt).Trim();

                                                    folder = lnstr.Substring(fldin1, prtindx - fldin1);
                                                    string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(fldindx).Trim();
                                                }
                                                else if (prtindx > dtindx)
                                                {
                                                    if (fldindx < dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx > dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                }
                                            }
                                        }
                                        else if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx < 0)
                                        {
                                            if (amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx > refindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                refst = lnstr.Substring(refin1, amtindx - refin1);

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx < 0)
                                        {
                                            if (amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx > dtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0)
                                        {
                                            if (refindx < dtindx)
                                            {
                                                refst = lnstr.Substring(refin1, dtindx - refin1).Trim();
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx > dtindx)
                                            {
                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                        }
                                        else if (amtindx >= 0 && prtindx >= 0 && refindx < 0 && dtindx < 0)
                                        {
                                            if (amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx > prtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && prtindx >= 0 && refindx >= 0 && dtindx < 0)
                                        {
                                            if (refindx < prtindx)
                                            {

                                                refst = lnstr.Substring(refin1, prtindx - refin1);
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx > prtindx)
                                            {

                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && prtindx >= 0 && refindx < 0 && dtindx >= 0)
                                        {
                                            if (dtindx < prtindx)
                                            {
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx > prtindx)
                                            {
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx < 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx > fldindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1);

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && prtindx < 0 && refindx >= 0 && dtindx < 0 && fldindx >= 0)
                                        {
                                            if (refindx < fldindx)
                                            {

                                                refst = lnstr.Substring(refin1, fldindx - refin1);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx > prtindx)
                                            {

                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && prtindx < 0 && refindx < 0 && dtindx >= 0 && fldindx >= 0)
                                        {
                                            if (dtindx < fldindx)
                                            {
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx > fldindx)
                                            {
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (prtindx < fldindx)
                                            {
                                                int diffamt = fldindx - prtin1;
                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx > fldindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                folder = lnstr.Substring(fldin1, prtindx - fldin1);

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx < 0 && prtindx < 0)
                                        {
                                            int diffamt = lnstr.Length - amtin1;
                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                            string string1 = trmamt;

                                            amt = Convert.ToDouble(string1);

                                            mainstr = lnstr.Remove(amtindx).Trim();
                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx < 0 && prtindx < 0)
                                        {
                                            refst = lnstr.Substring(refin1, lnstr.Length - refin1).Trim();

                                            mainstr = lnstr.Remove(refindx).Trim();
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx >= 0 && prtindx < 0)
                                        {
                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();

                                            mainstr = lnstr.Remove(dtindx).Trim();
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx < 0 && prtindx >= 0)
                                        {
                                            party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                            mainstr = lnstr.Remove(prtindx).Trim();
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx < 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                            mainstr = lnstr.Remove(fldindx).Trim();
                                        }
                                       
                                       
                                        if (folder != "" && party != "")
                                        {
                                            DataTable dtminprt = new DataTable();
                                            dtminprt = clsDocument.SelectFolderName(folder,ddlbusiness.SelectedValue);
                                            if (dtminprt.Rows.Count > 0)
                                            {
                                                if (dtminprt.Rows[0]["FolderName"] != System.DBNull.Value && dtminprt.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                {
                                                    folderid = Convert.ToInt32(dtminprt.Rows[0][0].ToString());
                                                    Docnam = dtminprt.Rows[0][1].ToString();

                                                    if (Docnam == folder)
                                                    {
                                                        //Docnam = folder;
                                                    }
                                                    else
                                                    {

                                                        DataTable dtdocsubid = new DataTable();
                                                        dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General",ddlbusiness.SelectedValue);
                                                        if (dtdocsubid.Rows.Count > 0)
                                                        {
                                                            if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                            {
                                                                i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                            }
                                                        }
                                                        Int32 rst = clsDocument.InsertDocumentType1(i34, folder);

                                                        folderid = rst;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                //Int32 i = 0;
                                                DataTable dtdocsubid = new DataTable();
                                                dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General",ddlbusiness.SelectedValue);
                                                if (dtdocsubid.Rows.Count > 0)
                                                {
                                                    if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                    {
                                                        i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                    }
                                                }
                                                Int32 rst = clsDocument.InsertDocumentType1(i34, folder);
                                                folderid = rst;
                                            }
                                            DataTable dtminprt1 = new DataTable();
                                            dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMaster(party,ddlbusiness.SelectedValue);
                                            if (dtminprt1.Rows.Count > 0)
                                            {
                                                if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                {
                                                    prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                }
                                            }
                                            if (prtid == 0)
                                            {
                                                if (party != "")
                                                {
                                                    EmployeeCls clsEmployee = new EmployeeCls();
                                                   // Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                   // Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, party, "Na", "1223", 0, 0, 0, 0, "4556","");
                                                    //      Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                    prtid = UserEntry();
                                                  //  prtid = partyid;
                                                }
                                                else
                                                {
                                                    DataTable dtminprt12 = new DataTable();
                                                    dtminprt12 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                    if (dtminprt1.Rows.Count > 0)
                                                    {
                                                        if (dtminprt12.Rows[0]["PartyId"] != System.DBNull.Value)
                                                        {
                                                            prtid = Convert.ToInt32(dtminprt12.Rows[0][0].ToString());
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                        else if (folder != "" && party == "")
                                        {
                                            DataTable dtminprt = new DataTable();
                                            dtminprt = clsDocument.SelectFolderName(folder,ddlbusiness.SelectedValue);
                                            if (dtminprt.Rows.Count > 0)
                                            {
                                                if (dtminprt.Rows[0]["FolderName"] != System.DBNull.Value && dtminprt.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                {
                                                    folderid = Convert.ToInt32(dtminprt.Rows[0][0].ToString());
                                                    Docnam = dtminprt.Rows[0][1].ToString();

                                                    if (folderid > 0)
                                                    {
                                                        DataTable dtprtfmfld = new DataTable();
                                                        dtprtfmfld = clsDocument.SelectPartyIdFromFolderID(folderid);
                                                        if (dtprtfmfld.Rows.Count > 0)
                                                        {
                                                            if (dtprtfmfld.Rows[0]["PartyId"] != System.DBNull.Value)
                                                            {
                                                                prtid = Convert.ToInt32(dtprtfmfld.Rows[0]["PartyId"].ToString());
                                                            }
                                                        }
                                                        if (prtid == 0 || prtid < 0)
                                                        {

                                                            DataTable dtminprt1 = new DataTable();
                                                            dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                            if (dtminprt1.Rows.Count > 0)
                                                            {
                                                                if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                                {
                                                                    prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                                }
                                                            }


                                                          
                                                            // Int32 prtfld = clsMaster.insertPartyFolderRelation1(Convert.ToString(prtid), folderid, Partydefaultfolder, Folderdefaultparty);

                                                        }
                                                       
                                                    }
                                                    else
                                                    {
                                                        //Int32 i = 0;
                                                        DataTable dtdocsubid = new DataTable();
                                                        dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General",ddlbusiness.SelectedValue);
                                                        if (dtdocsubid.Rows.Count > 0)
                                                        {
                                                            if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                            {
                                                                i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                            }
                                                        }
                                                        Int32 rst = clsDocument.InsertDocumentType1(i34, folder);

                                                        EmployeeCls clsEmployee = new EmployeeCls();
                                                        //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                        //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, folder, "Na", "1223", 0, 0, 0, 0, "4556","");
                                                       // Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");

                                                        prtid = UserEntry();
                                                       // Int32 prtfld = clsMaster.insertPartyFolderRelation1(Convert.ToString(partyid), rst, Partydefaultfolder, Folderdefaultparty);
                                                        //prtid = partyid;

                                                        folderid = rst;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                //Int32 i = 0;
                                                DataTable dtdocsubid = new DataTable();
                                                dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General",ddlbusiness.SelectedValue);
                                                if (dtdocsubid.Rows.Count > 0)
                                                {
                                                    if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                    {
                                                        i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                    }
                                                }
                                                Int32 rst = clsDocument.InsertDocumentType1(i34, folder);

                                                EmployeeCls clsEmployee = new EmployeeCls();
                                                //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, folder, "Na", "1223", 0, 0, 0, 0, "4556","");
                                                //  Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                prtid = UserEntry();
                                                bool Partydefaultfolder = false;
                                                bool Folderdefaultparty = true;
                                               // Int32 prtfld = clsMaster.insertPartyFolderRelation1(Convert.ToString(partyid), rst, Partydefaultfolder, Folderdefaultparty);
                                               // prtid = partyid;

                                                folderid = rst;
                                            }
                                        }
                                        else if (folder == "" && party != "")
                                        {
                                            DataTable dtminprt = new DataTable();
                                            dtminprt = clsDocument.SelectMinPartyIdfromPartyMaster(party,ddlbusiness.SelectedValue);
                                            if (dtminprt.Rows.Count > 0)
                                            {
                                                if (dtminprt.Rows[0]["PartyId"] != System.DBNull.Value)
                                                {
                                                    prtid = Convert.ToInt32(dtminprt.Rows[0][0].ToString());
                                                }
                                                if (prtid > 0)
                                                {
                                                    DataTable dtfldfmprt = new DataTable();
                                                    dtfldfmprt = clsDocument.SelectFolderIdFromPartyID(prtid);
                                                    if (dtfldfmprt.Rows.Count > 0)
                                                    {
                                                        if (dtfldfmprt.Rows[0]["FolderId"] != System.DBNull.Value)
                                                        {
                                                            folderid = Convert.ToInt32(dtfldfmprt.Rows[0]["FolderId"].ToString());
                                                        }

                                                        //bool Partydefaultfolder = true;
                                                        //bool Folderdefaultparty = false;
                                                        //Int32 prtfld = clsMaster.insertPartyFolderRelation1(Convert.ToString(prtid), folderid, Partydefaultfolder, Folderdefaultparty);
                                                    }
                                                    if (folderid == 0)
                                                    {
                                                       
                                                        
                                                            DataTable dtgen = new DataTable();
                                                            dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                            if (dtgen.Rows.Count > 0)
                                                            {
                                                                if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                                {
                                                                    ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                                }
                                                            }
                                                        
                                                        
                                                        folderid = ign;
                                                    }
                                                }
                                            }
                                            if (prtid == 0)
                                            {
                                                if (party != "")
                                                {
                                                    EmployeeCls clsEmployee = new EmployeeCls();
                                                   // Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                   // Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, party, "Na", "1223", 0, 0, 0, 0, "4556","");
                                                    //  Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                    prtid = UserEntry();

                                                   
                                                    
                                                        DataTable dtgen = new DataTable();
                                                        dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                        if (dtgen.Rows.Count > 0)
                                                        {
                                                            if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                            {
                                                                ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                            }
                                                        }
                                                   
                                                       folderid = ign;
                                                   
                                                }
                                                else
                                                {
                                                    DataTable dtminprt1 = new DataTable();
                                                    dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMaster("General",ddlbusiness.SelectedValue);
                                                    if (dtminprt1.Rows.Count > 0)
                                                    {
                                                        if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                        {
                                                            prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                        }
                                                    }

                                                    //Int32 i = 0;
                                                    DataTable dtdocsubid = new DataTable();
                                                    dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General",ddlbusiness.SelectedValue);
                                                    if (dtdocsubid.Rows.Count > 0)
                                                    {
                                                        if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                        {
                                                            i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                        }
                                                    }
                                                    Int32 rst = clsDocument.InsertDocumentType1(i34, party);
                                                   
                                                    //Int32 prtfld = clsMaster.insertPartyFolderRelation1(Convert.ToString(prtid), rst, Partydefaultfolder, Folderdefaultparty);

                                                    folderid = rst;
                                                }
                                            }
                                        }
                                        else if (folder == "" && party == "")
                                        {


                                            
                                           
                                                DataTable dtgen = new DataTable();
                                                dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                if (dtgen.Rows.Count > 0)
                                                {
                                                    if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                    {
                                                        ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                    }
                                                }
                                           
                                            if (ign == 0)
                                            {
                                                DataTable dtdocsubid = new DataTable();
                                                dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General",ddlbusiness.SelectedValue);
                                                if (dtdocsubid.Rows.Count > 0)
                                                {
                                                    if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                    {
                                                        i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                    }
                                                }
                                                Int32 rst = clsDocument.InsertDocumentType1(i34, party);
                                                folderid = rst;
                                            }
                                            folderid = ign;

                                            
                                           
                                                DataTable dtminprt1 = new DataTable();
                                                dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                if (dtminprt1.Rows.Count > 0)
                                                {
                                                    if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                    {
                                                        prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                    }
                                                }
                                            
                                            if (prtid == 0)
                                            {
                                                DataTable dtminprt11 = new DataTable();
                                                dtminprt11 = clsDocument.SelectMinPartyIdfromPartyMaster("General",ddlbusiness.SelectedValue);
                                                if (dtminprt11.Rows.Count > 0)
                                                {
                                                    if (dtminprt11.Rows[0]["PartyId"] != System.DBNull.Value)
                                                    {
                                                        prtid = Convert.ToInt32(dtminprt11.Rows[0][0].ToString());
                                                    }
                                                }
                                            }

                                           
                                        }


                                       
                                        if ( Convert.ToString(dt.Rows[0]["DocumentTypeId"])!="")
                                        {
                                            folderid = Convert.ToInt32(dt.Rows[0]["DocumentTypeid"]);
                                        }
                                        if (Convert.ToString(dt.Rows[0]["PartyId"])!="")
                                        {
                                            prtid = Convert.ToInt32(dt.Rows[0]["Partyid"]);
                                        }
                                        if (Convert.ToString(dt.Rows[0]["DocumentTittle"]) != "")
                                        {
                                            lnstr = Convert.ToString(dt.Rows[0]["DocumentTittle"]);
                                        }
                                            if (dat != "")
                                            {
                                                
                                                DocId = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToShortDateString()), filename1.ToString(), lnstr, "Description", prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(dat), extstr);
                                            }
                                            else
                                            {
                                                DocId = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToShortDateString()), filename1.ToString(), lnstr, "Description", prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(System.DateTime.Now.ToString()), extstr);
                                            }
                                            if (DocId > 0)
                                            {
                                                string filepath1 = Server.MapPath("~//Account//"+Session["comid"]+"//UploadedDocuments//" + filename1);
                                                int ii = 0;
                                                using (StreamReader st = new StreamReader(File.OpenRead(filepath1)))
                                                {
                                                    Regex regex = new Regex(@"/Type\s*/Page[^s]");
                                                    MatchCollection match = regex.Matches(st.ReadToEnd());
                                                    ii = match.Count;
                                                }

                                                int length = filename1.Length;
                                                string docnameIn = filename1.Substring(0, length - 4);


                                                for (int kk = 1; kk <= ii; kk++)
                                                {
                                                    string scpf = docnameIn;
                                                    scpf = scpf + "0000" + kk + ".jpg";
                                                    clsEmployee.InserDocumentImageMaster(DocId, scpf);

                                                }
                                                bool dcaprv = true;
                                                bool indc = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), DocId, dcaprv);
                                            }
                                        //}
                                            if (System.IO.File.Exists(location + f.Name))
                                            {
                                            }
                                            else
                                            {
                                                System.IO.File.Copy(FolderPath + f.Name, location + f.Name);
                                            }
                                        System.IO.File.SetAttributes(FolderPath + f.Name, System.IO.FileAttributes.Hidden);
                                      //  pnlmsg.Visible = true;
                                        lblmsg.Visible = true;
                                        lblmsg.Text = " Retrieve Successfully.";
                                        

                                    }

                                  
                                }
                                }

                                catch (Exception exp)
                                {
                                    if (con.State.ToString() != "Open")
                                    {
                                        con.Open();
                                    }


                                    SqlCommand ftpcmd1 = new SqlCommand("FolderAutoRetrivalMsgTbl", con);
                                    ftpcmd1.CommandType = CommandType.StoredProcedure;
                                    ftpcmd1.Parameters.Add(new SqlParameter("@FolderId", SqlDbType.NVarChar));
                                    ftpcmd1.Parameters["@FolderId"].Value = FolderId;
                                    ftpcmd1.Parameters.Add(new SqlParameter("@LasttimeChecked", SqlDbType.DateTime));
                                    ftpcmd1.Parameters["@LasttimeChecked"].Value = DateTime.Now.ToString();

                                    ftpcmd1.Parameters.Add(new SqlParameter("@Message ", SqlDbType.NVarChar));
                                    ftpcmd1.Parameters["@Message "].Value = exp.ToString();
                                    ftpcmd1.ExecuteNonQuery();
                                    con.Close();
                                    Flaggg = 2;
                                }
                                if (Flaggg == 0)
                                {
                                    if (con.State.ToString() != "Open")
                                    {
                                        con.Open();
                                    }

                                    SqlCommand ftpcmd11 = new SqlCommand("FolderAutoRetrivalMsgTbl", con);
                                    ftpcmd11.CommandType = CommandType.StoredProcedure;
                                    ftpcmd11.Parameters.Add(new SqlParameter("@FolderId", SqlDbType.NVarChar));
                                    ftpcmd11.Parameters["@FolderId"].Value = FolderId;
                                    ftpcmd11.Parameters.Add(new SqlParameter("@LasttimeChecked", SqlDbType.DateTime));
                                    ftpcmd11.Parameters["@LasttimeChecked"].Value = DateTime.Now.ToString();

                                    ftpcmd11.Parameters.Add(new SqlParameter("@Message ", SqlDbType.NVarChar));
                                    ftpcmd11.Parameters["@Message "].Value = "Data Retrieved Successfully";
                                    ftpcmd11.ExecuteNonQuery();

                                    con.Close();
                                }
                                Flaggg = 0;
                            }

                             
                        }
                        i = i + 1;
                    } while (i <= grdDesignation.Rows.Count - 1);
                    if (insdata == false)
                    {
                        lblmsg.Visible = true;
                   //     pnlmsg.Visible = true;
                        lblmsg.Text = "Error Please select atleast one path to download folder.";
                    }
                    else
                    {
                       // pnlmsg.Visible = true;
                        lblmsg.Visible = true;
                        lblmsg.Text = " Retrieve Successfully.";
                       
                    }
                    if (chked == false)
                    {
                       // pnlmsg.Visible = true;
                        lblmsg.Visible = true;
                        lblmsg.Text = "Please select atleast one path to download folder.";
                    }


                }
                
            }
        }
        catch (Exception ex)
        {
          //  pnlmsg.Visible = true;
            lblmsg.Visible = true;
            lblmsg.Text = "Error Downloading Folder:" + ex.Message.ToString();
        }
    }

    protected void grdDesignation_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        // try
        //{
        //    if (grdDesignation.Rows.Count > 0)
        //    {
        //        CheckBox cbHeader = (CheckBox)grdDesignation.HeaderRow.FindControl("HeaderChkboxDes");
        //        cbHeader.Attributes["onclick"] = "ChangeAllCheckBoxStatesDes(this.checked);";
        //        List<string> ArrayValuesdes = new List<string>();
        //        ArrayValuesdes.Add(string.Concat("'", cbHeader.ClientID, "'"));
        //        foreach (GridViewRow gvr in grdDesignation.Rows)
        //        {
        //            CheckBox cb = (CheckBox)gvr.FindControl("chkDesignation");
        //            cb.Attributes["onclick"] = "ChangeHeaderAsNeededDes();";
        //            ArrayValuesdes.Add(string.Concat("'", cb.ClientID, "'"));
        //        }
        //        CheckBoxIDsArrayDes.Text = "<script type='text/javascript'>" + "\n" + "<!--" + "\n" + String.Concat("var CheckBoxIDsDes =  new Array(", String.Join(",", ArrayValuesdes.ToArray()), ");") + "\n // -->" + "\n" + "</script>";
        //        //CheckBoxIDsArray.Text = "<script type=\"text/javascript\">" + Constants.vbCrLf + "<!--" + Constants.vbCrLf + string.Concat("var CheckBoxIDs = new Array(", string.Join(",", ArrayValues.ToArray()), ");") + Constants.vbCrLf + "// -->" + Constants.vbCrLf + "</script>";
        //    }
        //    else
        //    {
        //    }
        //}
        //catch (Exception ex)
        //{
        //    pnlmsg.Visible = true;
        //    lblmsg.Text = "Error in  DataBound : " + ex.Message.ToString();
        //}

    }

    protected void MoveDocument()
    {
        ///======Transfer Document and Add in to document master===============
        string filextn = "";
        string Location = Server.MapPath("~//Account//UploadedDocuments//");
        System.IO.DirectoryInfo dir = new System.IO.DirectoryInfo(Location);
        foreach (System.IO.FileInfo f in dir.GetFiles("*.pdf"))
        {
            string Location1 = Server.MapPath("~//Account//UploadedDocumentsTemp//");

            bool success = false;

            if (File.GetAttributes(Location + f.Name).ToString() != FileAttributes.Hidden.ToString())
            {
                string filename = DateTime.Now.Day.ToString() + DateTime.Now.Month.ToString() + DateTime.Now.Year.ToString() + "@" + DateTime.Now.Hour.ToString() + DateTime.Now.Minute.ToString() + "_" + f.Name;
                //string filename = f.Name;
                File.Copy(Location + f.Name, Location1 + filename.ToString(), true);

                DataTable doc_email_down = new DataTable();
                //doc_email_down = clsDocument.SelectDocumentEmailDownloadMasterWithID();

                Int32 rst = clsDocument.InsertDocumentMaster(0, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename.ToString(), "", "", 0, "", 0, 1, Convert.ToDateTime(System.DateTime.Now.ToString()), filextn);


                File.SetAttributes(Location + f.Name, FileAttributes.Hidden);
            }
        }

    }


    protected void grdDesignation_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        grdDesignation.PageIndex = e.NewPageIndex;

        if (RadioButtonList1.SelectedValue == "0")
        {

            FillFtpGrid();
        }
        else if (RadioButtonList1.SelectedValue == "1")
        {

            FillEmailGrid();
        }
        else if (RadioButtonList1.SelectedValue == "2")
        {

            FillFolderGrid();
        }

    }
    protected void imgbtnreplay_Click(object sender, EventArgs e)
    {


    }
    protected void RadioButtonList1_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (RadioButtonList1.SelectedValue == "0")
        {
            grdDesignation.DataSource = null;
            grdDesignation.DataBind();
            FillFtpGrid();
        }
        else if (RadioButtonList1.SelectedValue == "1")
        {
            grdDesignation.DataSource = null;
            grdDesignation.DataBind();
            FillEmailGrid();
        }
        else if (RadioButtonList1.SelectedValue == "2")
        {
            grdDesignation.DataSource = null;
            grdDesignation.DataBind();
            FillFolderGrid();
        }

    }

    protected void fillret()
    {

        foreach (GridViewRow grd in grdDesignation.Rows)
        {
            int Id = Convert.ToInt32(grdDesignation.DataKeys[grd.DataItemIndex].Value);
            Label lbllastrettime = (Label)grd.FindControl("lbllastrettime");
            Label lbllastretmsg = (Label)grd.FindControl("lbllastretmsg");
            DataTable dtt = new DataTable();
            if (RadioButtonList1.SelectedValue == "0")
            {
                dtt = (DataTable)select("Select Top(1) AutoRetrivalMsgTbl.* from FtpMaster inner join AutoRetrivalMsgTbl on AutoRetrivalMsgTbl.Ftpid=FtpMaster.Ftpid  where FtpMaster.Ftpid='" + Id + "' order by AutoRetrivalMsgTbl.Id Desc");
                if (dtt.Rows.Count > 0)
                {
                    lbllastrettime.Text = Convert.ToString(dtt.Rows[0]["LasttimeChecked"]);
                    lbllastretmsg.Text = Convert.ToString(dtt.Rows[0]["Message"]);
                }
            }
            else if (RadioButtonList1.SelectedValue == "1")
            {
                dtt = (DataTable)select("Select Top(1) AutoRetrivalMsgTbl.* from DocumentEmailDownloadMaster inner join AutoRetrivalMsgTbl on AutoRetrivalMsgTbl.EmailId=DocumentEmailDownloadMaster.DocumentEmailDownloadID  where DocumentEmailDownloadMaster.DocumentEmailDownloadID='" + Id + "' order by AutoRetrivalMsgTbl.Id Desc");
                if (dtt.Rows.Count > 0)
                {
                    lbllastrettime.Text = Convert.ToString(dtt.Rows[0]["LasttimeChecked"]);
                    lbllastretmsg.Text = Convert.ToString(dtt.Rows[0]["Message"]);
                }
            }
            else if (RadioButtonList1.SelectedValue == "2")
            {
                dtt = (DataTable)select("Select Top(1) AutoRetrivalMsgTbl.* from DownloadFolder inner join AutoRetrivalMsgTbl on AutoRetrivalMsgTbl.FolderId=DownloadFolder.FolderId  where DownloadFolder.FolderId='" + Id + "' order by AutoRetrivalMsgTbl.Id Desc");
                if (dtt.Rows.Count > 0)
                {
                    lbllastrettime.Text = Convert.ToString(dtt.Rows[0]["LasttimeChecked"]);
                    lbllastretmsg.Text = Convert.ToString(dtt.Rows[0]["Message"]);
                }
            }
        }
    }
    protected DataTable select(string str)
    {

        SqlCommand cmd1 = new SqlCommand(str, con);
        cmd1.CommandType = CommandType.Text;
        SqlDataAdapter da = new SqlDataAdapter(cmd1);
        DataTable dt = new DataTable();
        da.Fill(dt);
        return dt;
    }
    protected void ddlbusiness_SelectedIndexChanged(object sender, EventArgs e)
    {
        RadioButtonList1_SelectedIndexChanged(sender, e);
    }
    protected void MoveFromFTP()
    {
        int is1;
        is1 = 0;
        bool insdata;
        insdata = false;
        string name = "";
        try
        {
            DataTable dt = new DataTable();
            dt = ClsCompany.selectCompanyMaster();
            if (Convert.ToString(dt.Rows[0]["FtpAccount"]) == "True")
            {
                bool chked = false;
                if (grdDesignation.Rows.Count > 0)
                {
                    do
                    {
                        CheckBox chkdegs = (CheckBox)grdDesignation.Rows[is1].FindControl("chkDesignation");

                        if (chkdegs.Checked == true)
                        {
                            chked = true;
                            insdata = true;
                            Int32 ftpid1;
                            ftpid1 = Convert.ToInt32(grdDesignation.DataKeys[is1].Value.ToString());
                            DataTable dt1 = new DataTable();
                            dt1 = clsDocument.SelectFTPMasterWithID(ftpid1);
                            if (dt1.Rows.Count > 0)
                            {
                                for (int h = 0; h < dt1.Rows.Count; h++)
                                {
                                    int Flaggg = 0;
                                    string[] separatorft1 = new string[] { "/" };
                                    string[] strSplitArrft1 = dt1.Rows[0]["FTP"].ToString().Split(separatorft1, StringSplitOptions.RemoveEmptyEntries);

                                    String productno = strSplitArrft1[0].ToString();
                                    string ftpurl = "";

                                    if (productno == "FTP:" || productno == "ftp:")
                                    {
                                        if (strSplitArrft1.Length >= 3)
                                        {
                                            ftpurl = strSplitArrft1[0].ToString() + "//" + strSplitArrft1[1].ToString() + ":" + dt1.Rows[0]["Ftppath"];
                                            for (int i = 2; i < strSplitArrft1.Length; i++)
                                            {
                                                ftpurl += "/" + strSplitArrft1[i].ToString();
                                            }
                                        }
                                        else
                                        {
                                            ftpurl = strSplitArrft1[0].ToString() + "//" + strSplitArrft1[1].ToString() + ":" + dt1.Rows[0]["Ftppath"];

                                        }
                                    }
                                    else
                                    {
                                        if (strSplitArrft1.Length >= 2)
                                        {
                                            ftpurl = "ftp://" + strSplitArrft1[0].ToString() + ":" + dt1.Rows[0]["Ftppath"];
                                            for (int i = 1; i < strSplitArrft1.Length; i++)
                                            {
                                                ftpurl += "/" + strSplitArrft1[i].ToString();
                                            }
                                        }
                                        else
                                        {
                                            ftpurl = "ftp://" + strSplitArrft1[0].ToString() + ":" + dt1.Rows[0]["Ftppath"];

                                        }

                                    }
                                    int ftpid = Convert.ToInt32(dt1.Rows[h]["FtpId"]);


                                    string ftp1 = "";
                                    ftp1 = ftpurl + "/";

                                    string username = dt1.Rows[h]["Username"].ToString();
                                    string password = dt1.Rows[h]["Password"].ToString();

                                    string locationt = Server.MapPath("~//Account//" + Session["Comid"] + "//Ftpdowndoc//");
                                    string locationt1 = Server.MapPath("~//Account//" + Session["Comid"] + "//FtpdowndocTemp//");
                                    // DirectoryInfo dir = new DirectoryInfo(ftp);

                                    //FtpWebRequest oFTP = (FtpWebRequest)FtpWebRequest.Create("ftp://192.168.6.49:21/Company Docs/");
                                    FtpWebRequest oFTP = (FtpWebRequest)FtpWebRequest.Create(ftp1);
                                    //oFTP.Method = WebRequestMethods.Ftp.DownloadFile;
                                    oFTP.Credentials = new NetworkCredential(username, password);
                                    oFTP.UseBinary = false;
                                    oFTP.UsePassive = true;
                                    oFTP.Method = WebRequestMethods.Ftp.ListDirectory;

                                    FtpWebResponse response = (FtpWebResponse)oFTP.GetResponse();
                                    StreamReader sr = new StreamReader(response.GetResponseStream());
                                    string str = sr.ReadLine();
                                    List<string> oList = new List<string>();
                                    while (str != null)
                                    {
                                        if (str.Length > 3)
                                        {
                                            name = str.Trim();
                                            string extension = name.Substring(name.Length - 3);
                                            if (Convert.ToString(extension) == "pdf")
                                            {
                                                oList.Add(str);
                                            }

                                        }
                                        str = sr.ReadLine();
                                    }
                                    sr.Close();
                                    response.Close();
                                    oFTP = null;
                                    int j = oList.Count;
                                    for (int i = 0; i < j; i++)
                                    {
                                        string filename = DateTime.Now.Day.ToString() + DateTime.Now.Month.ToString() + DateTime.Now.Year.ToString() + "@" + DateTime.Now.Hour.ToString() + DateTime.Now.Minute.ToString() + DateTime.Now.Second.ToString() + "_" + oList[i].ToString();

                                        string destpath = locationt.ToString() + filename.ToString();
                                        string destpathImage = locationt1.ToString() + filename.ToString();
                                        GetFile(ftp1.ToString(), oList[i].ToString(), destpath.ToString(), username.ToString(), password.ToString());
                                        GetFile(ftp1.ToString(), oList[i].ToString(), destpathImage.ToString(), username.ToString(), password.ToString());
                                        DeleteFile(ftp1.ToString(), oList[i].ToString(), username.ToString(), password.ToString());

                                    }


                                    try
                                    {
                                        //string Location = Server.MapPath("~//Account//UploadedDocuments//");
                                        string Location = Server.MapPath("~//Account//" + Session["Comid"] + "//UploadedDocuments//");
                                        string Location2 = Server.MapPath("~//Account//" + Session["Comid"] + "//Ftpdowndoc//");
                                        string Location3 = Server.MapPath("~//Account//" + Session["Comid"] + "//FtpdowndocTemp//");
                                        System.Threading.Thread.Sleep(5000);
                                        System.IO.DirectoryInfo dir2 = new System.IO.DirectoryInfo(Location2);
                                        foreach (System.IO.FileInfo f2 in dir2.GetFiles("*.*"))
                                        {

                                            string Location1 = Server.MapPath("~//Account//" + Session["Comid"] + "//DocumentImage//");

                                            bool success = false;

                                            if (System.IO.File.GetAttributes(Location2 + f2.Name).ToString() != System.IO.FileAttributes.Hidden.ToString())
                                            {


                                                string filename1 = f2.Name;
                                                string extstr1 = "";
                                                string whlstr1 = "";
                                                char[] separator11 = new char[] { '.' };
                                                string[] strSplitArr11 = filename1.Split(separator11);
                                                int i114 = Convert.ToInt32(strSplitArr11.Length);
                                                if (i114 == 2)
                                                {
                                                    whlstr1 = strSplitArr11[0].ToString();
                                                    extstr1 = strSplitArr11[1].ToString();
                                                }
                                                else if (i114 == 3)
                                                {
                                                    string[] starr11 = filename1.Split('.');

                                                    string fst = starr11[0].ToString();
                                                    string sncd = starr11[1].ToString();
                                                    extstr1 = starr11[2].ToString();

                                                }


                                                string fnam = f2.Name.Trim();

                                                string extension1 = fnam.Substring(fnam.Length - 3);
                                                if (Convert.ToString(extension1) == "pdf")
                                                {

                                                    string filepath = Server.MapPath("~//Account//pdftoimage.exe");
                                                    System.Diagnostics.ProcessStartInfo pti = new System.Diagnostics.ProcessStartInfo(filepath);
                                                    pti.UseShellExecute = false;
                                                    //pti.Arguments = "@"+Server.MapPath("~//Account//") + "pdftoimage -i UploadedDocuments//" + f.Name + " " + "-o" + " " + "DocumentImage//";
                                                    pti.Arguments = filepath + " -i Ftpdowndoc//" + f2.Name + " " + "-o" + " " + "DocumentImage//";

                                                    pti.RedirectStandardOutput = true;
                                                    pti.RedirectStandardInput = true;
                                                    pti.RedirectStandardError = true;
                                                    pti.WorkingDirectory = Server.MapPath("~//Account//" + Session["Comid"] + "//");
                                                    System.Diagnostics.Process ps = Process.Start(pti);
                                                    if (System.IO.File.Exists(Location + f2.Name))
                                                    {

                                                    }
                                                    else
                                                    {

                                                        System.IO.File.Copy(Location2 + f2.Name, Location + f2.Name);
                                                    }
                                                    System.IO.File.SetAttributes(Location2 + f2.Name, System.IO.FileAttributes.Hidden);

                                                }
                                                else
                                                {

                                                }
                                                string frtstr = "";
                                                string extstr = "";
                                                string whlstr = "";
                                                char[] separator1 = new char[] { '.' };
                                                string[] strSplitArr1 = filename1.Split(separator1);
                                                int i111 = Convert.ToInt32(strSplitArr1.Length);
                                                if (i111 == 2)
                                                {
                                                    whlstr = strSplitArr1[0].ToString();
                                                    extstr = strSplitArr1[1].ToString();
                                                }
                                                else if (i111 == 3)
                                                {
                                                    string[] starr1 = filename1.Split('.');

                                                    string fst = starr1[0].ToString();
                                                    string sncd = starr1[1].ToString();
                                                    string thrd = starr1[2].ToString();
                                                    whlstr = fst + "." + sncd;
                                                }
                                                else
                                                {

                                                }
                                                //string[] starr = filename1.Split('.');

                                                //string frtstr = starr[0].ToString();
                                                //string extstr = starr[1].ToString();


                                                DataTable doc_ftp_down = new DataTable();
                                                doc_ftp_down = clsDocument.SelectFTPMasterWithID(ftpid);
                                                String doc_title8 = "", doc_desc8 = "";
                                                Int32 partyid23, DocumentTypeId = 0, partyid8 = 0;
                                                string lnstr = "";
                                                string mainstr = "";
                                                string srchamt = "Amt";
                                                string srchref = "Ref";
                                                string srchdt = "Dt";
                                                string srchprt = "Party";
                                                string srchfld = "Folder";
                                                int amtindx = 0;
                                                int refindx = 0;
                                                int dtindx = 0;
                                                int prtindx = 0;
                                                int fldindx = 0;
                                                Double amt = 0.0;
                                                string refst = "";
                                                string dat = "";
                                                string party = "";
                                                string folder = "";
                                                char[] separator = new char[] { '-' };

                                                string Docnam = "";
                                                Int32 folderid = 0;
                                                Int32 prtid = 0;
                                                Int32 i34 = 0;
                                                Int32 ign = 0;
                                                Int32 ica = 0;
                                                if (whlstr == "")
                                                {
                                                    lnstr = filename1;
                                                }
                                                else if (whlstr != "")
                                                {
                                                    lnstr = whlstr;
                                                }
                                                //string lnstr = "Bell BillInvoice Ref:451646dt:09/11/2010 amt:154.02 party=COMCAST";
                                                //string lnstr = "";


                                                fldindx = lnstr.IndexOf(srchfld);
                                                dtindx = lnstr.IndexOf(srchdt);
                                                amtindx = lnstr.IndexOf(srchamt);
                                                refindx = lnstr.IndexOf(srchref);
                                                prtindx = lnstr.IndexOf(srchprt);
                                                if (amtindx < 0)
                                                {
                                                    string srch2amt = "AMT";
                                                    amtindx = lnstr.IndexOf(srch2amt);
                                                }
                                                if (refindx < 0)
                                                {
                                                    string srch2ref = "REF";
                                                    refindx = lnstr.IndexOf(srch2ref);
                                                }
                                                if (dtindx < 0)
                                                {
                                                    string srch2dt = "DT";
                                                    dtindx = lnstr.IndexOf(srch2dt);
                                                }
                                                if (prtindx < 0)
                                                {
                                                    string srch2prt = "PARTY";
                                                    prtindx = lnstr.IndexOf(srch2prt);
                                                }
                                                if (fldindx < 0)
                                                {
                                                    string srch2fld = "FOLDER";
                                                    fldindx = lnstr.IndexOf(srch2fld);
                                                }
                                                if (amtindx < 0)
                                                {
                                                    string srch3amt = "amt";
                                                    amtindx = lnstr.IndexOf(srch3amt);
                                                }
                                                if (refindx < 0)
                                                {
                                                    string srch3ref = "ref";
                                                    refindx = lnstr.IndexOf(srch3ref);
                                                }
                                                if (dtindx < 0)
                                                {
                                                    string srch3dt = "dt";
                                                    dtindx = lnstr.IndexOf(srch3dt);
                                                }
                                                if (prtindx < 0)
                                                {
                                                    string srch3prt = "party";
                                                    prtindx = lnstr.IndexOf(srch3prt);
                                                }
                                                if (fldindx < 0)
                                                {
                                                    string srch3fld = "folder";
                                                    fldindx = lnstr.IndexOf(srch3fld);
                                                }
                                                if (fldindx < 0)
                                                {
                                                    string srch4fld = "flder";
                                                    fldindx = lnstr.IndexOf(srch4fld);
                                                }
                                                if (prtindx < 0)
                                                {
                                                    string srch4prt = "prty";
                                                    prtindx = lnstr.IndexOf(srch4prt);
                                                }
                                                if (prtindx < 0)
                                                {
                                                    string srch5prt = "Prty";
                                                    prtindx = lnstr.IndexOf(srch5prt);
                                                }
                                                int amtin1 = amtindx + 4;
                                                int refin1 = refindx + 4;
                                                int dtin1 = dtindx + 3;
                                                int prtin1 = prtindx + 6;
                                                int fldin1 = fldindx + 7;
                                                if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                                {
                                                    if (amtindx < refindx && refindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = (refindx - 1) - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;


                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < refindx && refindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < refindx && refindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < refindx && refindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < refindx && refindx < fldindx && fldindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < refindx && refindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < refindx && refindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < dtindx && dtindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < refindx && refindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < prtindx && prtindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx < amtindx && amtindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < amtindx && amtindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < amtindx && amtindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < amtindx && amtindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < amtindx && amtindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < amtindx && amtindx < fldindx && fldindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < amtindx && amtindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < amtindx && amtindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < amtindx && amtindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < amtindx && amtindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < refindx && refindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < amtindx && amtindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < refindx && refindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < prtindx && prtindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < amtindx && amtindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < refindx && refindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < amtindx && amtindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < refindx && refindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < dtindx && dtindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < refindx && refindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < refindx && refindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < dtindx && dtindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < prtindx && prtindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < amtindx && amtindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < refindx && refindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < amtindx && amtindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < refindx && refindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < prtindx && prtindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < refindx && refindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < amtindx && amtindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < refindx && refindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < dtindx && dtindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx < 0)
                                                {
                                                    if (amtindx < refindx && refindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < refindx && refindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0 && fldindx >= 0)
                                                {
                                                    if (amtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                                if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                                {
                                                    if (amtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                        string[] strSplitArr = folder.Split(separator);

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                                {
                                                    if (amtindx < fldindx && fldindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < amtindx && amtindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < amtindx && amtindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                                {
                                                    if (fldindx < refindx && refindx < dtindx && dtindx < prtindx)
                                                    {
                                                        int diffamt = refindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < refindx && refindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = refindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = dtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = prtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx < prtindx && prtindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (refindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                                    {
                                                        int diffamt = prtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                                    {
                                                        int diffamt = refindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                                    {
                                                        int diffamt = prtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = refindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                                    {
                                                        int diffamt = refindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                                    {
                                                        int diffamt = dtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                                    {
                                                        int diffamt = refindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        //string string1 = folder;

                                                        //amt = Convert.ToDouble(string1);
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0 && fldindx < 0)
                                                {
                                                    if (amtindx < refindx)
                                                    {
                                                        if (amtindx < dtindx)
                                                        {
                                                            if (refindx < dtindx)
                                                            {
                                                                int diffamt = refindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = dtindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }
                                                                //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                            else if (refindx > dtindx)
                                                            {
                                                                int diffamt = dtindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttldat = refindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }
                                                                //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                        }
                                                        else if (amtindx > dtindx)
                                                        {
                                                            int diffamt = refindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                            int ttldat = amtindx - dtin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            mainstr = lnstr.Remove(amtindx).Trim();
                                                        }
                                                    }
                                                    else if (amtindx > refindx)
                                                    {
                                                        if (amtindx < dtindx)
                                                        {
                                                            int diffamt = dtindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            refst = lnstr.Substring(refin1, amtindx - refin1);
                                                            string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            mainstr = lnstr.Remove(refindx).Trim();
                                                        }
                                                        else if (amtindx > dtindx)
                                                        {
                                                            if (refindx < dtindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                refst = lnstr.Substring(refin1, dtindx - refin1);
                                                                int ttldat = amtindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(refindx).Trim();
                                                            }
                                                            else if (refindx > dtindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = amtindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                int ttldat = refindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(dtindx).Trim();
                                                            }
                                                        }
                                                    }

                                                }
                                                else if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx >= 0 && fldindx < 0)
                                                {
                                                    if (amtindx < refindx)
                                                    {
                                                        if (amtindx < prtindx)
                                                        {
                                                            if (refindx < prtindx)
                                                            {
                                                                int diffamt = refindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = prtindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                            else if (refindx > prtindx)
                                                            {
                                                                int diffamt = prtindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                                //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                        }
                                                        else if (amtindx > prtindx)
                                                        {
                                                            int diffamt = refindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                            party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                            mainstr = lnstr.Remove(amtindx).Trim();
                                                        }
                                                    }
                                                    else if (amtindx > refindx)
                                                    {
                                                        if (amtindx < prtindx)
                                                        {
                                                            int diffamt = prtindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            refst = lnstr.Substring(refin1, amtindx - refin1);
                                                            party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                            mainstr = lnstr.Remove(refindx).Trim();
                                                        }
                                                        else if (amtindx > prtindx)
                                                        {
                                                            if (refindx < prtindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                refst = lnstr.Substring(refin1, prtindx - refin1);
                                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                                mainstr = lnstr.Remove(refindx).Trim();
                                                            }
                                                            else if (refindx > prtindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = prtindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                                mainstr = lnstr.Remove(prtindx).Trim();
                                                            }
                                                        }
                                                    }

                                                }
                                                else if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx >= 0 && fldindx < 0)
                                                {
                                                    if (amtindx < dtindx)
                                                    {
                                                        if (amtindx < prtindx)
                                                        {
                                                            if (dtindx < prtindx)
                                                            {
                                                                int diffamt = dtindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttldat = prtindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                                //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            }
                                                            else if (dtindx > prtindx)
                                                            {
                                                                int diffamt = prtindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                                //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                int ttldat = lnstr.Length - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }

                                                        }
                                                        else if (amtindx > prtindx)
                                                        {
                                                            int diffamt = dtindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            int ttldat = lnstr.Length - dtin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                            mainstr = lnstr.Remove(amtindx).Trim();
                                                        }
                                                    }
                                                    else if (amtindx > dtindx)
                                                    {
                                                        if (amtindx < prtindx)
                                                        {
                                                            int diffamt = prtindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            int ttldat = amtindx - dtin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                            mainstr = lnstr.Remove(dtindx).Trim();
                                                        }
                                                        else if (amtindx > prtindx)
                                                        {
                                                            if (dtindx < prtindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttldat = prtindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                                mainstr = lnstr.Remove(dtindx).Trim();
                                                            }
                                                            else if (dtindx > prtindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttldat = prtindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                                mainstr = lnstr.Remove(prtindx).Trim();
                                                            }
                                                        }
                                                    }

                                                }
                                                else if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx < 0)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        if (refindx < prtindx)
                                                        {
                                                            if (dtindx < prtindx)
                                                            {
                                                                int ttlref = dtindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                int ttldat = prtindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                                mainstr = lnstr.Remove(refindx).Trim();
                                                                //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            }
                                                            else if (dtindx > prtindx)
                                                            {

                                                                int ttlref = prtindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                                //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                int ttldat = lnstr.Length - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(refindx).Trim();
                                                            }
                                                        }
                                                        else if (refindx > prtindx)
                                                        {

                                                            int ttlref = dtindx - refin1;
                                                            if (ttlref > 10)
                                                            {
                                                                ttlref = 10;
                                                            }
                                                            refst = lnstr.Substring(refin1, ttlref);
                                                            int ttldat = lnstr.Length - dtin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                            mainstr = lnstr.Remove(prtindx).Trim();
                                                        }
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        if (refindx < prtindx)
                                                        {

                                                            int ttlref = prtindx - refin1;
                                                            if (ttlref > 10)
                                                            {
                                                                ttlref = 10;
                                                            }
                                                            refst = lnstr.Substring(refin1, ttlref);
                                                            int ttldat = refindx - dtin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                            mainstr = lnstr.Remove(dtindx).Trim();
                                                        }
                                                        else if (refindx > prtindx)
                                                        {
                                                            if (dtindx < prtindx)
                                                            {

                                                                int ttlref = lnstr.Length - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                int ttldat = prtindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();


                                                                mainstr = lnstr.Remove(dtindx).Trim();
                                                            }
                                                            else if (dtindx > prtindx)
                                                            {
                                                                int ttlref = lnstr.Length - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                int ttldat = refindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                                mainstr = lnstr.Remove(prtindx).Trim();
                                                            }
                                                        }
                                                    }


                                                }
                                                else if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx < 0 && fldindx >= 0)
                                                {
                                                    if (amtindx < refindx)
                                                    {
                                                        if (amtindx < fldindx)
                                                        {
                                                            if (refindx < fldindx)
                                                            {
                                                                int diffamt = refindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = fldindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                                //dat = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                            else if (refindx > fldindx)
                                                            {
                                                                int diffamt = fldindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttldat = refindx - fldin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                                //dat = lnstr.Substring(fldin1, ttldat).Trim();
                                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                        }
                                                        else if (amtindx > fldindx)
                                                        {
                                                            int diffamt = refindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                            int ttldat = amtindx - fldin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            folder = lnstr.Substring(fldin1, ttldat).Trim();


                                                            mainstr = lnstr.Remove(amtindx).Trim();
                                                        }
                                                    }
                                                    else if (amtindx > refindx)
                                                    {
                                                        if (amtindx < fldindx)
                                                        {
                                                            int diffamt = fldindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            refst = lnstr.Substring(refin1, amtindx - refin1);
                                                            folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();


                                                            mainstr = lnstr.Remove(refindx).Trim();
                                                        }
                                                        else if (amtindx > fldindx)
                                                        {
                                                            if (refindx < fldindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                refst = lnstr.Substring(refin1, fldindx - refin1);
                                                                int ttldat = amtindx - fldin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttldat).Trim();


                                                                mainstr = lnstr.Remove(refindx).Trim();
                                                            }
                                                            else if (refindx > fldindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = fldindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                int ttldat = refindx - fldin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                                mainstr = lnstr.Remove(fldindx).Trim();
                                                            }
                                                        }
                                                    }

                                                }
                                                else if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx < 0 && fldindx >= 0)
                                                {
                                                    if (amtindx < fldindx)
                                                    {
                                                        if (amtindx < dtindx)
                                                        {
                                                            if (fldindx < dtindx)
                                                            {
                                                                int diffamt = fldindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = dtindx - fldin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttlref);
                                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }
                                                                //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                            else if (fldindx > dtindx)
                                                            {
                                                                int diffamt = dtindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttldat = fldindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }
                                                                //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                        }
                                                        else if (amtindx > dtindx)
                                                        {
                                                            int diffamt = fldindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);
                                                            int ttldat = amtindx - dtin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            mainstr = lnstr.Remove(amtindx).Trim();
                                                        }
                                                    }
                                                    else if (amtindx > fldindx)
                                                    {
                                                        if (amtindx < dtindx)
                                                        {
                                                            int diffamt = dtindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            folder = lnstr.Substring(fldin1, amtindx - fldin1);
                                                            string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            mainstr = lnstr.Remove(fldindx).Trim();
                                                        }
                                                        else if (amtindx > dtindx)
                                                        {
                                                            if (fldindx < dtindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                folder = lnstr.Substring(fldin1, dtindx - fldin1);
                                                                int ttldat = amtindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(fldindx).Trim();
                                                            }
                                                            else if (fldindx > dtindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = dtindx - fldin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttlref);
                                                                int ttldat = fldindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(dtindx).Trim();
                                                            }
                                                        }
                                                    }

                                                }
                                                else if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0 && fldindx >= 0)
                                                {
                                                    if (fldindx < refindx)
                                                    {
                                                        if (fldindx < dtindx)
                                                        {
                                                            if (refindx < dtindx)
                                                            {
                                                                int diffamt = refindx - fldin1;
                                                                folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                                int ttlref = dtindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }
                                                                //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                mainstr = lnstr.Remove(fldindx).Trim();
                                                            }
                                                            else if (refindx > dtindx)
                                                            {
                                                                int diffamt = dtindx - fldin1;
                                                                folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                                int ttldat = refindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }
                                                                //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                                mainstr = lnstr.Remove(fldindx).Trim();
                                                            }
                                                        }
                                                        else if (fldindx > dtindx)
                                                        {
                                                            int diffamt = refindx - fldin1;
                                                            folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                            refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                            int ttldat = fldindx - dtin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            mainstr = lnstr.Remove(fldindx).Trim();
                                                        }
                                                    }
                                                    else if (fldindx > refindx)
                                                    {
                                                        if (fldindx < dtindx)
                                                        {
                                                            int diffamt = dtindx - fldin1;
                                                            folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                            refst = lnstr.Substring(refin1, fldindx - refin1);
                                                            string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            mainstr = lnstr.Remove(refindx).Trim();
                                                        }
                                                        else if (fldindx > dtindx)
                                                        {
                                                            if (refindx < dtindx)
                                                            {
                                                                int diffamt = lnstr.Length - fldin1;
                                                                folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                                refst = lnstr.Substring(refin1, dtindx - refin1);
                                                                int ttldat = fldindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(refindx).Trim();
                                                            }
                                                            else if (refindx > dtindx)
                                                            {
                                                                int diffamt = lnstr.Length - fldin1;
                                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                                string string1 = folder;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = dtindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                int ttldat = refindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(dtindx).Trim();
                                                            }
                                                        }
                                                    }
                                                }
                                                else if (amtindx >= 0 && refindx < 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                                {
                                                    if (amtindx < prtindx)
                                                    {
                                                        if (amtindx < fldindx)
                                                        {
                                                            if (prtindx < fldindx)
                                                            {
                                                                int diffamt = prtindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = fldindx - prtin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                party = lnstr.Substring(prtin1, ttlref);
                                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                                //dat = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                            else if (prtindx > fldindx)
                                                            {
                                                                int diffamt = fldindx - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttldat = prtindx - fldin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                                //dat = lnstr.Substring(fldin1, ttldat).Trim();
                                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1);

                                                                mainstr = lnstr.Remove(amtindx).Trim();
                                                            }
                                                        }
                                                        else if (amtindx > fldindx)
                                                        {
                                                            int diffamt = prtindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            party = lnstr.Substring(prtin1, lnstr.Length - prtin1);
                                                            int ttldat = amtindx - fldin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                            mainstr = lnstr.Remove(amtindx).Trim();
                                                        }
                                                    }
                                                    else if (amtindx > prtindx)
                                                    {
                                                        if (amtindx < fldindx)
                                                        {
                                                            int diffamt = fldindx - amtin1;
                                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                            string string1 = trmamt;

                                                            amt = Convert.ToDouble(string1);
                                                            party = lnstr.Substring(prtin1, amtindx - prtin1);
                                                            folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                            mainstr = lnstr.Remove(prtindx).Trim();
                                                        }
                                                        else if (amtindx > fldindx)
                                                        {
                                                            if (prtindx < fldindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                party = lnstr.Substring(prtin1, fldindx - prtin1);
                                                                int ttldat = amtindx - fldin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                                mainstr = lnstr.Remove(prtindx).Trim();
                                                            }
                                                            else if (prtindx > fldindx)
                                                            {
                                                                int diffamt = lnstr.Length - amtin1;
                                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                                string string1 = trmamt;

                                                                amt = Convert.ToDouble(string1);
                                                                int ttlref = fldindx - prtin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                party = lnstr.Substring(prtin1, ttlref);
                                                                int ttldat = prtindx - fldin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                                mainstr = lnstr.Remove(fldindx).Trim();
                                                            }
                                                        }
                                                    }
                                                }
                                                else if (amtindx < 0 && refindx >= 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                                {
                                                    if (prtindx < refindx)
                                                    {
                                                        if (prtindx < fldindx)
                                                        {
                                                            if (refindx < fldindx)
                                                            {
                                                                int diffamt = refindx - prtin1;
                                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                                int ttlref = fldindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                                //dat = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                                mainstr = lnstr.Remove(prtindx).Trim();
                                                            }
                                                            else if (refindx > fldindx)
                                                            {
                                                                int diffamt = fldindx - prtin1;
                                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                                int ttldat = refindx - fldin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                                //dat = lnstr.Substring(fldin1, ttldat).Trim();
                                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                                mainstr = lnstr.Remove(prtindx).Trim();
                                                            }
                                                        }
                                                        else if (prtindx > fldindx)
                                                        {
                                                            int diffamt = refindx - prtin1;
                                                            party = lnstr.Substring(prtin1, diffamt).Trim();

                                                            refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                            int ttldat = prtindx - fldin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                            mainstr = lnstr.Remove(prtindx).Trim();
                                                        }
                                                    }
                                                    else if (prtindx > refindx)
                                                    {
                                                        if (prtindx < fldindx)
                                                        {
                                                            int diffamt = fldindx - prtin1;
                                                            party = lnstr.Substring(prtin1, diffamt).Trim();

                                                            refst = lnstr.Substring(refin1, prtindx - refin1);
                                                            folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();


                                                            mainstr = lnstr.Remove(refindx).Trim();
                                                        }
                                                        else if (prtindx > fldindx)
                                                        {
                                                            if (refindx < fldindx)
                                                            {
                                                                int diffamt = lnstr.Length - prtin1;
                                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                                refst = lnstr.Substring(refin1, fldindx - refin1);
                                                                int ttldat = prtindx - fldin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttldat).Trim();


                                                                mainstr = lnstr.Remove(refindx).Trim();
                                                            }
                                                            else if (refindx > fldindx)
                                                            {
                                                                int diffamt = lnstr.Length - prtin1;
                                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                                int ttlref = fldindx - refin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                refst = lnstr.Substring(refin1, ttlref);
                                                                int ttldat = refindx - fldin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                                mainstr = lnstr.Remove(fldindx).Trim();
                                                            }
                                                        }
                                                    }
                                                }
                                                else if (amtindx < 0 && refindx < 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                                {
                                                    if (prtindx < fldindx)
                                                    {
                                                        if (prtindx < dtindx)
                                                        {
                                                            if (fldindx < dtindx)
                                                            {
                                                                int diffamt = fldindx - prtin1;
                                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                                int ttlref = dtindx - fldin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttlref);
                                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }
                                                                //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                                mainstr = lnstr.Remove(prtindx).Trim();
                                                            }
                                                            else if (fldindx > dtindx)
                                                            {
                                                                int diffamt = dtindx - prtin1;
                                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                                int ttldat = fldindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }
                                                                //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                                mainstr = lnstr.Remove(prtindx).Trim();
                                                            }
                                                        }
                                                        else if (prtindx > dtindx)
                                                        {
                                                            int diffamt = fldindx - prtin1;
                                                            party = lnstr.Substring(prtin1, diffamt).Trim();

                                                            folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);
                                                            int ttldat = prtindx - dtin1;
                                                            if (ttldat > 10)
                                                            {
                                                                ttldat = 10;
                                                            }
                                                            string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            mainstr = lnstr.Remove(prtindx).Trim();
                                                        }
                                                    }
                                                    else if (prtindx > fldindx)
                                                    {
                                                        if (prtindx < dtindx)
                                                        {
                                                            int diffamt = dtindx - prtin1;
                                                            party = lnstr.Substring(prtin1, diffamt).Trim();

                                                            folder = lnstr.Substring(fldin1, prtindx - fldin1);
                                                            string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            string[] strSplitArr = dttmp.Split(separator);
                                                            int i1 = Convert.ToInt32(strSplitArr.Length);
                                                            if (i1 == 3)
                                                            {
                                                                dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                            }
                                                            else
                                                            {
                                                                dat = "";
                                                            }

                                                            mainstr = lnstr.Remove(fldindx).Trim();
                                                        }
                                                        else if (prtindx > dtindx)
                                                        {
                                                            if (fldindx < dtindx)
                                                            {
                                                                int diffamt = lnstr.Length - prtin1;
                                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                                folder = lnstr.Substring(fldin1, dtindx - fldin1);
                                                                int ttldat = prtindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(fldindx).Trim();
                                                            }
                                                            else if (fldindx > dtindx)
                                                            {
                                                                int diffamt = lnstr.Length - prtin1;
                                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                                int ttlref = dtindx - fldin1;
                                                                if (ttlref > 10)
                                                                {
                                                                    ttlref = 10;
                                                                }
                                                                folder = lnstr.Substring(fldin1, ttlref);
                                                                int ttldat = fldindx - dtin1;
                                                                if (ttldat > 10)
                                                                {
                                                                    ttldat = 10;
                                                                }
                                                                string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                                string[] strSplitArr = dttmp.Split(separator);
                                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                                if (i1 == 3)
                                                                {
                                                                    dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                                }
                                                                else
                                                                {
                                                                    dat = "";
                                                                }

                                                                mainstr = lnstr.Remove(dtindx).Trim();
                                                            }
                                                        }
                                                    }
                                                }
                                                else if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx < 0)
                                                {
                                                    if (amtindx < refindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx > refindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        refst = lnstr.Substring(refin1, amtindx - refin1);

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }

                                                }
                                                else if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx < 0)
                                                {
                                                    if (amtindx < dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx > dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }

                                                }
                                                else if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        refst = lnstr.Substring(refin1, dtindx - refin1).Trim();
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx >= 0 && prtindx >= 0 && refindx < 0 && dtindx < 0)
                                                {
                                                    if (amtindx < prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx > prtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }

                                                }
                                                else if (amtindx < 0 && prtindx >= 0 && refindx >= 0 && dtindx < 0)
                                                {
                                                    if (refindx < prtindx)
                                                    {

                                                        refst = lnstr.Substring(refin1, prtindx - refin1);
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > prtindx)
                                                    {

                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }

                                                }
                                                else if (amtindx < 0 && prtindx >= 0 && refindx < 0 && dtindx >= 0)
                                                {
                                                    if (dtindx < prtindx)
                                                    {
                                                        string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx > prtindx)
                                                    {
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx >= 0 && refindx < 0 && dtindx < 0 && prtindx < 0 && fldindx >= 0)
                                                {
                                                    if (amtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (amtindx > fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        folder = lnstr.Substring(fldin1, amtindx - fldin1);

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }

                                                }
                                                else if (amtindx < 0 && prtindx < 0 && refindx >= 0 && dtindx < 0 && fldindx >= 0)
                                                {
                                                    if (refindx < fldindx)
                                                    {

                                                        refst = lnstr.Substring(refin1, fldindx - refin1);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > prtindx)
                                                    {

                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                        folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }

                                                }
                                                else if (amtindx < 0 && prtindx < 0 && refindx < 0 && dtindx >= 0 && fldindx >= 0)
                                                {
                                                    if (dtindx < fldindx)
                                                    {
                                                        string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx > fldindx)
                                                    {
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                                else if (amtindx < 0 && refindx < 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                                {
                                                    if (prtindx < fldindx)
                                                    {
                                                        int diffamt = fldindx - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx > fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        folder = lnstr.Substring(fldin1, prtindx - fldin1);

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                                else if (amtindx >= 0 && refindx < 0 && dtindx < 0 && prtindx < 0)
                                                {
                                                    int diffamt = lnstr.Length - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                                else if (amtindx < 0 && refindx >= 0 && dtindx < 0 && prtindx < 0)
                                                {
                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1).Trim();

                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (amtindx < 0 && refindx < 0 && dtindx >= 0 && prtindx < 0)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();

                                                    mainstr = lnstr.Remove(dtindx).Trim();
                                                }
                                                else if (amtindx < 0 && refindx < 0 && dtindx < 0 && prtindx >= 0)
                                                {
                                                    party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                    mainstr = lnstr.Remove(prtindx).Trim();
                                                }
                                                else if (amtindx < 0 && refindx < 0 && dtindx < 0 && prtindx < 0 && fldindx >= 0)
                                                {
                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                    mainstr = lnstr.Remove(fldindx).Trim();
                                                }

                                                if (folder != "" && party != "")
                                                {
                                                    DataTable dtminprt = new DataTable();
                                                    dtminprt = clsDocument.SelectFolderName(folder, ddlbusiness.SelectedValue);
                                                    if (dtminprt.Rows.Count > 0)
                                                    {
                                                        if (dtminprt.Rows[0]["FolderName"] != System.DBNull.Value && dtminprt.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                        {
                                                            folderid = Convert.ToInt32(dtminprt.Rows[0][0].ToString());
                                                            Docnam = dtminprt.Rows[0][1].ToString();

                                                            if (Docnam == folder.ToUpper())
                                                            {
                                                                //Docnam = folder;
                                                            }
                                                            else
                                                            {
                                                                DataTable dtgen = new DataTable();
                                                                dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                                if (dtgen.Rows.Count > 0)
                                                                {
                                                                    if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                                    {
                                                                        ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                                    }
                                                                }
                                                                if (ign == 0)
                                                                {
                                                                    DataTable dtdocsubid = new DataTable();
                                                                    dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                                    if (dtdocsubid.Rows.Count > 0)
                                                                    {
                                                                        if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                                        {
                                                                            i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                                        }
                                                                    }

                                                                    if (i34 == 0)
                                                                    {
                                                                        DataTable dtcab = new DataTable();
                                                                        dtcab = clsDocument.SelectGeneralCabinetId();
                                                                        if (dtcab.Rows.Count > 0)
                                                                        {
                                                                            if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                                            {
                                                                                ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                                            }
                                                                        }
                                                                        if (ica == 0)
                                                                        {
                                                                            Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                                            if (rst > 0)
                                                                            {
                                                                                Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                                if (rst1 > 0)
                                                                                {
                                                                                    Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                                    if (rst2 > 0)
                                                                                    {
                                                                                        folderid = rst2;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                                            if (rst1 > 0)
                                                                            {
                                                                                Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                                if (rst2 > 0)
                                                                                {
                                                                                    folderid = rst2;
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                                        if (rst2 > 0)
                                                                        {
                                                                            folderid = rst2;
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    folderid = ign;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //Int32 i = 0;
                                                        DataTable dtgen = new DataTable();
                                                        dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                        if (dtgen.Rows.Count > 0)
                                                        {
                                                            if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                            {
                                                                ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                            }
                                                        }
                                                        if (ign == 0)
                                                        {
                                                            DataTable dtdocsubid = new DataTable();
                                                            dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                            if (dtdocsubid.Rows.Count > 0)
                                                            {
                                                                if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                                {
                                                                    i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                                }
                                                            }
                                                            if (i34 == 0)
                                                            {
                                                                DataTable dtcab = new DataTable();
                                                                dtcab = clsDocument.SelectGeneralCabinetId();
                                                                if (dtcab.Rows.Count > 0)
                                                                {
                                                                    if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                                    {
                                                                        ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                                    }
                                                                }
                                                                if (ica == 0)
                                                                {
                                                                    Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                                    if (rst > 0)
                                                                    {
                                                                        Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                        if (rst1 > 0)
                                                                        {
                                                                            Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                            if (rst2 > 0)
                                                                            {
                                                                                folderid = rst2;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                                    if (rst1 > 0)
                                                                    {
                                                                        Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                        if (rst2 > 0)
                                                                        {
                                                                            folderid = rst2;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                                if (rst2 > 0)
                                                                {
                                                                    folderid = rst2;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            folderid = ign;
                                                        }
                                                    }
                                                    DataTable dtminprt1 = new DataTable();
                                                    dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMaster(party, ddlbusiness.SelectedValue);
                                                    if (dtminprt1.Rows.Count > 0)
                                                    {
                                                        if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                        {
                                                            prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                        }
                                                    }
                                                    if (prtid == 0)
                                                    {
                                                        if (party != "")
                                                        {
                                                            EmployeeCls clsEmployee = new EmployeeCls();
                                                            clsMaster = new MasterCls();
                                                            //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                            //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, party, "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                            //Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                            //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");

                                                            //prtid = partyid;
                                                        }
                                                        else
                                                        {
                                                            DataTable dtminprt12 = new DataTable();
                                                            dtminprt12 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                            if (dtminprt1.Rows.Count > 0)
                                                            {
                                                                if (dtminprt12.Rows[0]["PartyId"] != System.DBNull.Value)
                                                                {
                                                                    prtid = Convert.ToInt32(dtminprt12.Rows[0][0].ToString());
                                                                }
                                                            }
                                                            if (prtid == 0)
                                                            {
                                                                EmployeeCls clsEmployee = new EmployeeCls();
                                                                //clsMaster = new MasterCls();
                                                                //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                                //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                                //Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                                //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");

                                                                prtid = UserEntry();
                                                            }
                                                        }
                                                    }
                                                }
                                                else if (folder != "" && party == "")
                                                {
                                                    DataTable dtminprt = new DataTable();
                                                    dtminprt = clsDocument.SelectFolderName(folder, ddlbusiness.SelectedValue);
                                                    if (dtminprt.Rows.Count > 0)
                                                    {
                                                        if (dtminprt.Rows[0]["FolderName"] != System.DBNull.Value && dtminprt.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                        {
                                                            folderid = Convert.ToInt32(dtminprt.Rows[0][0].ToString());
                                                            Docnam = dtminprt.Rows[0][1].ToString();

                                                            if (folderid > 0)
                                                            {
                                                                DataTable dtprtfmfld = new DataTable();
                                                                dtprtfmfld = clsDocument.SelectPartyIdFromFolderID(folderid);
                                                                if (dtprtfmfld.Rows.Count > 0)
                                                                {
                                                                    if (dtprtfmfld.Rows[0]["PartyId"] != System.DBNull.Value)
                                                                    {
                                                                        prtid = Convert.ToInt32(dtprtfmfld.Rows[0]["PartyId"].ToString());
                                                                    }
                                                                    if (dtprtfmfld.Rows[0]["Folderdefaultparty"] != System.DBNull.Value)
                                                                    {
                                                                        bool dfltprt = Convert.ToBoolean(dtprtfmfld.Rows[0]["Folderdefaultparty"].ToString());
                                                                    }
                                                                }
                                                                if (prtid == 0 || prtid < 0)
                                                                {
                                                                    DataTable dtminprt1 = new DataTable();
                                                                    dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                                    if (dtminprt1.Rows.Count > 0)
                                                                    {
                                                                        if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                                        {
                                                                            prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                                        }
                                                                    }
                                                                    if (prtid == 0)
                                                                    {
                                                                        EmployeeCls clsEmployee = new EmployeeCls();
                                                                        clsMaster = new MasterCls();
                                                                        //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                                        //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                                        //Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                                        //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                                        prtid = UserEntry();
                                                                        //prtid = partyid;
                                                                    }

                                                                }
                                                                //Docnam = folder;
                                                            }
                                                            else
                                                            {
                                                                //Int32 i = 0;
                                                                DataTable dtgen = new DataTable();
                                                                dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                                if (dtgen.Rows.Count > 0)
                                                                {
                                                                    if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                                    {
                                                                        ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                                    }
                                                                }
                                                                if (ign == 0)
                                                                {
                                                                    DataTable dtdocsubid = new DataTable();
                                                                    dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                                    if (dtdocsubid.Rows.Count > 0)
                                                                    {
                                                                        if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                                        {
                                                                            i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                                        }
                                                                    }
                                                                    if (i34 == 0)
                                                                    {
                                                                        DataTable dtcab = new DataTable();
                                                                        dtcab = clsDocument.SelectGeneralCabinetId();
                                                                        if (dtcab.Rows.Count > 0)
                                                                        {
                                                                            if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                                            {
                                                                                ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                                            }
                                                                        }
                                                                        if (ica == 0)
                                                                        {
                                                                            Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                                            if (rst > 0)
                                                                            {
                                                                                Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                                if (rst1 > 0)
                                                                                {
                                                                                    Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                                    if (rst2 > 0)
                                                                                    {
                                                                                        folderid = rst2;
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                                            if (rst1 > 0)
                                                                            {
                                                                                Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                                if (rst2 > 0)
                                                                                {
                                                                                    folderid = rst2;
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                                        if (rst2 > 0)
                                                                        {
                                                                            folderid = rst2;
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    folderid = ign;
                                                                }

                                                                DataTable dtminprt1 = new DataTable();
                                                                dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                                if (dtminprt1.Rows.Count > 0)
                                                                {
                                                                    if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                                    {
                                                                        prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                                    }
                                                                }
                                                                if (prtid == 0)
                                                                {
                                                                    EmployeeCls clsEmployee = new EmployeeCls();
                                                                    clsMaster = new MasterCls();
                                                                    //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                                    //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                                    //Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                                    //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                                    prtid = UserEntry();
                                                                    //prtid = partyid;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //Int32 i = 0;
                                                        DataTable dtgen = new DataTable();
                                                        dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                        if (dtgen.Rows.Count > 0)
                                                        {
                                                            if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                            {
                                                                ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                            }
                                                        }
                                                        if (ign == 0)
                                                        {
                                                            DataTable dtdocsubid = new DataTable();
                                                            dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                            if (dtdocsubid.Rows.Count > 0)
                                                            {
                                                                if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                                {
                                                                    i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                                }
                                                            }
                                                            if (i34 == 0)
                                                            {
                                                                DataTable dtcab = new DataTable();
                                                                dtcab = clsDocument.SelectGeneralCabinetId();
                                                                if (dtcab.Rows.Count > 0)
                                                                {
                                                                    if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                                    {
                                                                        ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                                    }
                                                                }
                                                                if (ica == 0)
                                                                {
                                                                    Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                                    if (rst > 0)
                                                                    {
                                                                        Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                        if (rst1 > 0)
                                                                        {
                                                                            Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                            if (rst2 > 0)
                                                                            {
                                                                                folderid = rst2;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                                    if (rst1 > 0)
                                                                    {
                                                                        Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                        if (rst2 > 0)
                                                                        {
                                                                            folderid = rst2;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                                if (rst2 > 0)
                                                                {
                                                                    folderid = rst2;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            folderid = ign;
                                                        }

                                                        DataTable dtminprt1 = new DataTable();
                                                        dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                        if (dtminprt1.Rows.Count > 0)
                                                        {
                                                            if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                            {
                                                                prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                            }
                                                        }
                                                        if (prtid == 0)
                                                        {
                                                            EmployeeCls clsEmployee = new EmployeeCls();
                                                            clsMaster = new MasterCls();
                                                            //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                            //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                            ////Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                            //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                            prtid = UserEntry();
                                                            //prtid = partyid;
                                                        }
                                                    }
                                                }
                                                else if (folder == "" && party != "")
                                                {
                                                    DataTable dtminprt = new DataTable();
                                                    dtminprt = clsDocument.SelectMinPartyIdfromPartyMaster(party, ddlbusiness.SelectedValue);
                                                    if (dtminprt.Rows.Count > 0)
                                                    {
                                                        if (dtminprt.Rows[0]["PartyId"] != System.DBNull.Value)
                                                        {
                                                            prtid = Convert.ToInt32(dtminprt.Rows[0][0].ToString());
                                                        }
                                                        if (prtid > 0)
                                                        {
                                                            DataTable dtfldfmprt = new DataTable();
                                                            dtfldfmprt = clsDocument.SelectFolderIdFromPartyID(prtid);
                                                            if (dtfldfmprt.Rows.Count > 0)
                                                            {
                                                                if (dtfldfmprt.Rows[0]["FolderId"] != System.DBNull.Value)
                                                                {
                                                                    folderid = Convert.ToInt32(dtfldfmprt.Rows[0]["FolderId"].ToString());
                                                                }
                                                                prtid = UserEntry();
                                                                //bool Partydefaultfolder = true;
                                                                //bool Folderdefaultparty = false;
                                                                //Int32 prtfld = clsMaster.insertPartyFolderRelation1(Convert.ToString(prtid), folderid, Partydefaultfolder, Folderdefaultparty);
                                                            }
                                                        }
                                                    }
                                                    if (prtid == 0)
                                                    {
                                                        if (party != "")
                                                        {
                                                            EmployeeCls clsEmployee = new EmployeeCls();
                                                            //clsMaster = new MasterCls();
                                                            //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                            //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, party, "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                            ////Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                            //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                            prtid = UserEntry();
                                                            // prtid = partyid;

                                                        }
                                                        else
                                                        {
                                                            DataTable dtminprt1 = new DataTable();
                                                            dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                            if (dtminprt1.Rows.Count > 0)
                                                            {
                                                                if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                                {
                                                                    prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                                }
                                                            }
                                                            if (prtid == 0)
                                                            {
                                                                EmployeeCls clsEmployee = new EmployeeCls();
                                                                clsMaster = new MasterCls();
                                                                //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                                //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, party, "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                                ////Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                                //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                                prtid = UserEntry();
                                                                //prtid = partyid;
                                                            }
                                                        }
                                                    }
                                                    if (folderid == 0)
                                                    {
                                                        //Int32 i = 0;
                                                        DataTable dtgen = new DataTable();
                                                        dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                        if (dtgen.Rows.Count > 0)
                                                        {
                                                            if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                            {
                                                                ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                            }
                                                        }
                                                        if (ign == 0)
                                                        {
                                                            DataTable dtdocsubid = new DataTable();
                                                            dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                            if (dtdocsubid.Rows.Count > 0)
                                                            {
                                                                if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                                {
                                                                    i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                                }
                                                            }
                                                            if (i34 == 0)
                                                            {
                                                                DataTable dtcab = new DataTable();
                                                                dtcab = clsDocument.SelectGeneralCabinetId();
                                                                if (dtcab.Rows.Count > 0)
                                                                {
                                                                    if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                                    {
                                                                        ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                                    }
                                                                }
                                                                if (ica == 0)
                                                                {
                                                                    Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                                    if (rst > 0)
                                                                    {
                                                                        Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                        if (rst1 > 0)
                                                                        {
                                                                            Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                            if (rst2 > 0)
                                                                            {
                                                                                folderid = rst2;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                                    if (rst1 > 0)
                                                                    {
                                                                        Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                        if (rst2 > 0)
                                                                        {
                                                                            folderid = rst2;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                                if (rst2 > 0)
                                                                {
                                                                    folderid = rst2;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            folderid = ign;
                                                        }
                                                    }
                                                }
                                                else if (folder == "" && party == "")
                                                {
                                                    DataTable dtgen = new DataTable();
                                                    dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                    if (dtgen.Rows.Count > 0)
                                                    {
                                                        if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                        {
                                                            ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                        }
                                                    }
                                                    if (ign == 0)
                                                    {
                                                        DataTable dtdocsubid = new DataTable();
                                                        dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                        if (dtdocsubid.Rows.Count > 0)
                                                        {
                                                            if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                            {
                                                                i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                            }
                                                        }
                                                        if (i34 == 0)
                                                        {
                                                            DataTable dtcab = new DataTable();
                                                            dtcab = clsDocument.SelectGeneralCabinetId();
                                                            if (dtcab.Rows.Count > 0)
                                                            {
                                                                if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                                {
                                                                    ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                                }
                                                            }
                                                            if (ica == 0)
                                                            {
                                                                Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                                if (rst > 0)
                                                                {
                                                                    Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                    if (rst1 > 0)
                                                                    {
                                                                        Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                        if (rst2 > 0)
                                                                        {
                                                                            folderid = rst2;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                                if (rst1 > 0)
                                                                {
                                                                    Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                    if (rst2 > 0)
                                                                    {
                                                                        folderid = rst2;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                            if (rst2 > 0)
                                                            {
                                                                folderid = rst2;
                                                            }
                                                        }                                            //Int32 rst = clsDocument.InsertDocumentType1(i34, folder);
                                                    }
                                                    else
                                                    {

                                                        folderid = ign;
                                                    }

                                                    DataTable dtminprt1 = new DataTable();
                                                    dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                    if (dtminprt1.Rows.Count > 0)
                                                    {
                                                        if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                        {
                                                            prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                        }
                                                    }
                                                    if (prtid == 0)
                                                    {

                                                        //EmployeeCls clsEmployee = new EmployeeCls();
                                                        //clsMaster = new MasterCls();
                                                        //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                        //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                        ////Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                        //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                        prtid = UserEntry();
                                                        //prtid = partyid;
                                                    }

                                                }
                                                string doc_desc = "";
                                                //filename1 = "Doc From FTP";
                                                Int32 rst35 = 0;
                                                if (doc_ftp_down.Rows[0]["FTPMasterDefaultPropId"].ToString() != "" || doc_ftp_down.Rows[0]["FTPMasterDefaultPropId"] != System.DBNull.Value)
                                                {
                                                    doc_title8 = Convert.ToString(doc_ftp_down.Rows[0]["DocumentTitle"].ToString());
                                                    doc_desc8 = Convert.ToString(doc_ftp_down.Rows[0]["DocumentDescription"].ToString());
                                                    partyid8 = Convert.ToInt32(doc_ftp_down.Rows[0]["PartyId"].ToString());
                                                    DocumentTypeId = Convert.ToInt32(doc_ftp_down.Rows[0]["DocumentTypeId"].ToString());
                                                }
                                                if (doc_ftp_down.Rows[0]["FTPMasterDefaultPropId"].ToString() != "" || doc_ftp_down.Rows[0]["FTPMasterDefaultPropId"] != System.DBNull.Value)
                                                {
                                                    Int32 rst = 0;
                                                    amt = 0.0;
                                                    //if (dat != "")
                                                    //{
                                                    //    rst = clsDocument.InsertDocumentMaster(DocumentTypeId, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), lnstr, doc_desc8, partyid8, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(dat), extstr1);
                                                    //}
                                                    //else
                                                    //{
                                                    rst = clsDocument.InsertDocumentMaster(DocumentTypeId, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title8, doc_desc8, partyid8, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(System.DateTime.Now.ToString()), extstr1);
                                                    //}
                                                    if (rst > 0)
                                                    {
                                                        imagefo(filename1.ToString(), rst);
                                                        if (doc_ftp_down.Rows[0]["DocumentAutoApprove"].ToString() != "")
                                                        {
                                                            bool st = Convert.ToBoolean(doc_ftp_down.Rows[0]["DocumentAutoApprove"].ToString());
                                                            if (st.ToString() == "True")
                                                            {
                                                                bool dcaprv = true;
                                                                bool indc = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), rst, dcaprv);
                                                            }
                                                        }
                                                    }
                                                }
                                                else if (doc_ftp_down.Rows[0]["FTPMasterDefaultPropId"].ToString() == "")
                                                {
                                                    if (dat != "")
                                                    {
                                                        rst35 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), lnstr, doc_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(dat), extstr1);

                                                    }
                                                    else
                                                    {
                                                        rst35 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), lnstr, doc_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(System.DateTime.Now.ToString()), extstr1);
                                                    }
                                                    if (rst35 > 0)
                                                    {
                                                        imagefo(filename1.ToString(), rst35);
                                                        bool st = Convert.ToBoolean(doc_ftp_down.Rows[0]["DocumentAutoApprove"].ToString());
                                                        if (st.ToString() == "True")
                                                        {
                                                            bool dcaprv = true;
                                                            bool indc = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), rst35, dcaprv);
                                                        }

                                                    }
                                                }

                                                if (System.IO.File.Exists(Location + f2.Name))
                                                {
                                                }
                                                else
                                                {
                                                    System.IO.File.Copy(Location2 + f2.Name, Location + f2.Name);
                                                }
                                                System.IO.File.SetAttributes(Location2 + f2.Name, System.IO.FileAttributes.Hidden);
                                            }

                                        }

                                    }
                                    catch (Exception es)
                                    {
                                        lblmsg.Visible = true;
                                        lblmsg.Text = "Message : " + es.Message;

                                        if (con.State.ToString() != "Open")
                                        {
                                            con.Open();
                                        }
                                        SqlCommand ftpcmd1 = new SqlCommand("FtpidAutoRetrivalMsgTbl", con);
                                        ftpcmd1.CommandType = CommandType.StoredProcedure;
                                        ftpcmd1.Parameters.Add(new SqlParameter("@Ftpid", SqlDbType.NVarChar));
                                        ftpcmd1.Parameters["@Ftpid"].Value = ftpid1;
                                        ftpcmd1.Parameters.Add(new SqlParameter("@LasttimeChecked", SqlDbType.DateTime));
                                        ftpcmd1.Parameters["@LasttimeChecked"].Value = DateTime.Now.ToString();

                                        ftpcmd1.Parameters.Add(new SqlParameter("@Message ", SqlDbType.NVarChar));
                                        ftpcmd1.Parameters["@Message "].Value = es.ToString();
                                        ftpcmd1.ExecuteNonQuery();
                                        con.Close();
                                        Flaggg = 2;


                                    }
                                    if (Flaggg == 0)
                                    {
                                        if (con.State.ToString() != "Open")
                                        {
                                            con.Open();
                                        }
                                        SqlCommand ftpcmd1 = new SqlCommand("FtpidAutoRetrivalMsgTbl", con);
                                        ftpcmd1.CommandType = CommandType.StoredProcedure;
                                        ftpcmd1.Parameters.Add(new SqlParameter("@Ftpid", SqlDbType.NVarChar));
                                        ftpcmd1.Parameters["@Ftpid"].Value = ftpid1;
                                        ftpcmd1.Parameters.Add(new SqlParameter("@LasttimeChecked", SqlDbType.DateTime));
                                        ftpcmd1.Parameters["@LasttimeChecked"].Value = DateTime.Now.ToString();

                                        ftpcmd1.Parameters.Add(new SqlParameter("@Message ", SqlDbType.NVarChar));
                                        ftpcmd1.Parameters["@Message "].Value = "Data Retrieved Successfully";
                                        ftpcmd1.ExecuteNonQuery();
                                        con.Close();


                                        lblmsg.Visible = true;
                                        lblmsg.Text = "Successfully downloaded.";
                                    }
                                    Flaggg = 0;

                                }
                            }
                        }
                        is1 = is1 + 1;
                    } while (is1 <= grdDesignation.Rows.Count - 1);
                    if (insdata == false)
                    {
                        // pnlmsg.Visible = true;
                        lblmsg.Visible = true;

                        lblmsg.Text = "Error : Please select atleast one path to download folder.";
                        lblmsg.Visible = true;
                    }
                    else
                    {
                        //   pnlmsg.Visible = true;
                        lblmsg.Visible = true;
                        lblmsg.Text = " Retrieve Successfully.";

                    }
                    if (chked == false)
                    {
                        // pnlmsg.Visible = true;
                        lblmsg.Visible = true;
                        lblmsg.Text = "Please select atleast one path to download folder.";

                    }


                }
            }
        }
        catch (Exception ex)
        {
            // pnlmsg.Visible = true;
            lblmsg.Visible = true;
            lblmsg.Text = "FTP Download Error:" + ex.Message.ToString();

        }
    }
    protected void imagefo(String filename1, Int32 DocId)
    {

        string filepath1 = Server.MapPath("~//Account//" + Session["comid"] + "//UploadedDocuments//" + filename1);
        int ii = 0;
        using (StreamReader st = new StreamReader(File.OpenRead(filepath1)))
        {
            Regex regex = new Regex(@"/Type\s*/Page[^s]");
            MatchCollection match = regex.Matches(st.ReadToEnd());
            ii = match.Count;
        }

        int length = filename1.Length;
        string docnameIn = filename1.Substring(0, length - 4);


        for (int kk = 1; kk <= ii; kk++)
        {
            string scpf = docnameIn;
            scpf = scpf + "0000" + kk + ".jpg";
            clsEmployee.InserDocumentImageMaster(DocId, scpf);

        }
        bool dcaprv = true;
        bool indc = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), DocId, dcaprv);
        //   pnlmsg.Visible = true;
        lblmsg.Visible = true;
        lblmsg.Text = " Retrieve Successfully.";

    }
    public bool GetFile(string ftp, string filename, string Destpath, string username, string password)
    {
        FtpWebRequest oFTP = (FtpWebRequest)FtpWebRequest.
           Create(ftp.ToString() + filename.ToString());

        oFTP.Credentials = new NetworkCredential(username.ToString(), password.ToString());
        oFTP.UseBinary = false;
        oFTP.UsePassive = true;
        oFTP.Method = WebRequestMethods.Ftp.DownloadFile;


        FtpWebResponse response =
           (FtpWebResponse)oFTP.GetResponse();
        Stream responseStream = response.GetResponseStream();

        FileStream fs = new FileStream(Destpath, FileMode.CreateNew);
        Byte[] buffer = new Byte[2047];
        int read = 1;
        while (read != 0)
        {
            read = responseStream.Read(buffer, 0, buffer.Length);
            fs.Write(buffer, 0, read);
        }

        responseStream.Close();
        fs.Flush();
        fs.Close();
        responseStream.Close();
        response.Close();

        oFTP = null;
        return true;
    }
    public bool DeleteFile(string ftp, string filename, string username, string password)
    {
        FtpWebRequest oFTPDel = (FtpWebRequest)FtpWebRequest.
         Create(ftp.ToString() + filename.ToString());

        oFTPDel.Credentials = new NetworkCredential(username.ToString(), password.ToString());

        oFTPDel.Method = WebRequestMethods.Ftp.DeleteFile;

        FtpWebResponse responseDel = (FtpWebResponse)oFTPDel.GetResponse();
        FtpStatusCode oStatDel = responseDel.StatusCode;
        responseDel.Close();
        oFTPDel = null;
        return true;
    }

    public void MoveFromMail()
    {
        int i1;
        i1 = 0;
        bool insdata;
        insdata = false;
        try
        {

            string location = Server.MapPath("~//Account//" + Session["Comid"] + "//UploadedDocuments//");
            string location1 = Server.MapPath("~//Account//" + Session["Comid"] + "//DocumentImageTemp//");
            DataTable dt = new DataTable();
            dt = ClsCompany.selectCompanyMaster();
            if (Convert.ToString(dt.Rows[0]["MailAccounts"]) == "True" || Convert.ToString(dt.Rows[0]["MailAccounts"]) == "False" || Convert.ToString(dt.Rows[0]["MailAccounts"]) == "")
            {
                bool chked = false;
                if (grdDesignation.Rows.Count > 0)
                {
                    do
                    {
                        CheckBox chkdegs = (CheckBox)grdDesignation.Rows[i1].FindControl("chkDesignation");

                        if (chkdegs.Checked == true)
                        {
                            chked = true;
                            insdata = true;
                            Int32 DocumentEmailDownloadID;
                            DocumentEmailDownloadID = Convert.ToInt32(grdDesignation.DataKeys[i1].Value.ToString());
                            DataTable dt1 = new DataTable();
                            dt1 = clsDocument.SelectDocumentEmailDownloadMasterWithID(DocumentEmailDownloadID);
                            foreach (DataRow dr in dt1.Rows)
                            {


                                bool i = DownloadMail(dr["ServerName"].ToString(), dr["EmailId"].ToString(), dr["Password"].ToString(), location.ToString(), Convert.ToInt32(dr["LastDownloadIndex"]), Convert.ToInt32(dr["DocumentEmailDownloadID"]), Convert.ToBoolean(dr["DocumentAutoApprove"]));
                                //bool j = DownloadMail(dr["ServerName"].ToString(), dr["EmailId"].ToString(), dr["Password"].ToString(), Convert.ToDateTime(dr["LastDownloadedTime"].ToString()), location1.ToString(), Convert.ToInt32(dr["LastDownloadIndex"]));



                            }
                        }
                        i1 = i1 + 1;
                    } while (i1 <= grdDesignation.Rows.Count - 1);
                    if (insdata == false)
                    {
                        lblmsg.Visible = true;
                        //  pnlmsg.Visible = true;
                        lblmsg.Text = "ErrorPlease select atleast one path to download folder.";
                    }
                    else
                    {
                        lblmsg.Visible = true;
                        //  pnlmsg.Visible = true;
                        lblmsg.Text = " Retrieve Successfully.";
                    }
                    if (chked == false)
                    {
                        // pnlmsg.Visible = true;
                        lblmsg.Visible = true;
                        lblmsg.Text = "Please select atleast one path to download folder.";

                    }


                }

            }
            lblmsg.Visible = true;
            // pnlmsg.Visible = true;
            lblmsg.Text = "Retrieve Successfully.";

        }
        catch (Exception ex)
        {
            //  pnlmsg.Visible = true;
            lblmsg.Text = "Error Downloading Mail:" + ex.Message.ToString();
            lblmsg.Visible = true;
        }
    }
    public bool DownloadMail(string server, string Email, string password, string DestPath, int LastDownloadIndex, int DocumentEmailDownloadID, bool docautoapprove)
    {
        string location = Server.MapPath("~//Account//" + Session["Comid"] + "//UploadedDocuments//");
        string location12 = Server.MapPath("~//Account//" + Session["Comid"] + "//UploadedDocumentsTemp//");

        ForAspNet.POP3.License.LicenseKey = "D0NhcG1hbiBMdGQgUjI5OQEAAAABAAAA/z839HUoyiulFja7UZFbY3sZ6Q9mwIxPBhmGr7oX4+0PgLDF4APv+woUNOa+DYcN9XkD9r+SmFQ=";
        //docautoapprove = true;

        //ForAspNet.POP3.License.LicenseKey = "FWhhaXl1Z2FqamFyQGdtYWlsLmNvbQEAAAAAAAAAcIc1pXCsywgEUz0mjTOAafZyvZE+0LPIACuAJyphd1jmsRYlJEuuoBlkNXRgor8nstpwsL4z0l4=";
        POP3 objPOP3 = new POP3(server.ToString(), Email.ToString(), password.ToString());

        objPOP3.Connect();
        if (objPOP3.IsAPOPSupported)
        {
            objPOP3.SecureLogin();
        }
        else
        {
            objPOP3.Login();
        }
        objPOP3.QueryServer();
        // download 10 mail at a time for singe email id using count===========================
        int count = 0;

        for (int index = LastDownloadIndex + 1; index <= objPOP3.TotalMailCount; index++)
        {
            if (count <= 5)
            {
                count = count + 1;
                string filename, name;
                EmailMessage objEmail = objPOP3.GetMessage(index, false);

                //if (Convert.ToDateTime(objEmail.Date) > Convert.ToDateTime(lastDownloadTime))
                //{
                bool i = clsDocument.UpdateDocumentEmailLastDownloadIndex(DocumentEmailDownloadID, Convert.ToInt32(index));
                string msgsubject = objEmail.Subject.ToString();
                string fromparty = objEmail.From.ToString();
                string msgbody = objEmail.Body.ToString();
                if (objEmail.IsAnyAttachments)
                {

                    for (int attCount = 0; attCount < objEmail.Attachments.Count; attCount++)
                    {
                        ForAspNet.POP3.Attachment att = (Attachment)objEmail.Attachments[attCount];

                        if (att.IsFileAttachment)
                        {
                            //name = att.FileName.Trim();
                            //string extension = name.Substring(name.Length - 3);
                            //if (Convert.ToString(extension) == "pdf")
                            //{
                            filename = DateTime.Now.Day.ToString() + DateTime.Now.Month.ToString() + DateTime.Now.Year.ToString() + "_" + DateTime.Now.Hour.ToString() + DateTime.Now.Minute.ToString() + DateTime.Now.Second.ToString() + "_" + Email.ToString() + "_" + att.FileName;
                            att.Save(DestPath.ToString() + filename.ToString());
                            if (System.IO.File.Exists(location12 + filename))
                            {
                            }
                            else
                            {
                                File.Copy(DestPath.ToString() + filename.ToString(), location12.ToString() + filename.ToString(), true);
                            }

                            //DataTable dt_def_pro= new DataTable();
                            //dt_def_pro = clsDocument.SelectDocumentEmailDownloadMasterWithID(DocumentEmailDownloadID);
                            //----------------------
                            string Location = Server.MapPath("~//Account//" + Session["Comid"] + "//UploadedDocuments//");
                            System.IO.DirectoryInfo dir = new System.IO.DirectoryInfo(Location);
                            foreach (System.IO.FileInfo f in dir.GetFiles(filename))
                            {
                                string Location1 = Server.MapPath("~//Account//" + Session["Comid"] + "//UploadedDocumentsTemp//");
                                //bool success = false;
                                if (File.GetAttributes(location + f.Name).ToString() != FileAttributes.Hidden.ToString())
                                {
                                    //string filename = DateTime.Now.Day.ToString() + DateTime.Now.Month.ToString() + DateTime.Now.Year.ToString() + "@" + DateTime.Now.Hour.ToString() + DateTime.Now.Minute.ToString() + "_" + f.Name;
                                    string filename1 = f.Name;
                                    if (System.IO.File.Exists(Location + f.Name))
                                    {
                                    }
                                    else
                                    {
                                        File.Copy(Location1 + f.Name, Location + filename1.ToString(), true);
                                    }
                                    System.IO.File.SetAttributes(Location1 + f.Name, System.IO.FileAttributes.Hidden);
                                    DataTable doc_email_down = new DataTable();
                                    doc_email_down = clsDocument.SelectDocumentEmailDownloadMasterWithID(DocumentEmailDownloadID);
                                    String doc_title, doc_email_desc = "";
                                    Int32 partyid1, DocumentTypeId;
                                    String doc_title7 = "", doc_email_desc7 = "";
                                    Int32 partyid17 = 0, DocumentTypeId7 = 0;
                                    if (doc_email_down.Rows[0]["DocumentEmailDownloadDefaultPropId"] != System.DBNull.Value)
                                    {
                                        if (doc_email_down.Rows[0]["DocumentEmailDownloadDefaultPropId"].ToString() != "")
                                        {
                                            doc_email_desc7 = Convert.ToString(doc_email_down.Rows[0]["DocumentDescription"].ToString());
                                            partyid17 = Convert.ToInt32(doc_email_down.Rows[0]["PartyId"].ToString());
                                            DocumentTypeId7 = Convert.ToInt32(doc_email_down.Rows[0]["DocumentTypeId"].ToString());
                                            doc_title7 = Convert.ToString(doc_email_down.Rows[0]["DocumentTittle"].ToString());
                                        }
                                    }
                                    string flext = Path.GetExtension(location + f.Name);
                                    if (flext == ".pdf")
                                    {
                                        string filepath = Server.MapPath("~//Account//pdftoimage.exe");
                                        System.Diagnostics.ProcessStartInfo pti = new System.Diagnostics.ProcessStartInfo(filepath);
                                        //string flpt = "D:\\Capman.ifilecabinet.com1\\Account\\test.txt";
                                        //pti.FileName = Server.MapPath("~//Account//pdftoimage.exe");
                                        pti.UseShellExecute = false;
                                        //pti.Arguments = "@"+Server.MapPath("~//Account//") + "pdftoimage -i UploadedDocuments//" + f.Name + " " + "-o" + " " + "DocumentImage//";
                                        pti.Arguments = filepath + " -i UploadedDocuments//" + f.Name + " " + "-o" + " " + "DocumentImage//";

                                        pti.RedirectStandardOutput = true;
                                        pti.RedirectStandardInput = true;
                                        pti.RedirectStandardError = true;
                                        //pti.WorkingDirectory = "D:\\Capman.ifilecabinet.com1\\Account\\";
                                        pti.WorkingDirectory = Server.MapPath("~//Account//" + Session["Comid"] + "//");
                                        System.Diagnostics.Process ps = Process.Start(pti);
                                    }
                                    //bool doctittleoremailsub = Convert.ToBoolean(doc_email_down.Rows[0]["DocTittleOrEmailSub"].ToString());
                                    bool doctittleoremailsub = true;
                                    //string doctittleoremailsub = doc_email_down.Rows[0]["DocTittleOrEmailSub"].ToString();
                                    /*string lnstr = "";
                                    string mainstr = "";
                                    string srchamt = "amt";
                                    string srchref = "ref";
                                    string srchdt = "dt";
                                    string srchprt = "party";
                                    int amtindx = 0;
                                    int refindx = 0;
                                    int dtindx = 0;
                                    int prtindx = 0;
                                    Double amt = 0.0;
                                    string refst = "";
                                    string dat = "";
                                    string party = "";
                                    Int32 prtid = 0;
                                    char[] separator = new char[] { '/' };*/
                                    string lnstr = "";
                                    string mainstr = "";
                                    string srchamt = "Amt";
                                    string srchref = "Ref";
                                    string srchdt = "Dt";
                                    string srchprt = "Party";
                                    string srchfld = "Folder";
                                    int amtindx = 0;
                                    int refindx = 0;
                                    int dtindx = 0;
                                    int prtindx = 0;
                                    int fldindx = 0;
                                    Double amt = 0.0;
                                    string refst = "";
                                    string dat = "";
                                    string party = "";
                                    string folder = "";
                                    char[] separator = new char[] { '-' };
                                    string Docnam = "";
                                    Int32 folderid = 0;
                                    Int32 prtid = 0;
                                    Int32 i34 = 0;
                                    Int32 ign = 0;
                                    Int32 ica = 0;
                                    string extstr = "";
                                    if (doctittleoremailsub == true)
                                    {
                                        doc_title = objEmail.Subject.ToString();

                                        string frtstr = "";

                                        string whlstr = "";
                                        string whlexstr = "";
                                        char[] separator1 = new char[] { '.' };
                                        string[] strSplitArr1 = att.FileName.Split(separator1);
                                        int i111 = Convert.ToInt32(strSplitArr1.Length);
                                        if (i111 == 2)
                                        {
                                            whlexstr = strSplitArr1[0].ToString();
                                            extstr = strSplitArr1[1].ToString();
                                        }
                                        else if (i111 == 3)
                                        {
                                            string[] starr1 = att.FileName.Split('.');

                                            string fst = starr1[0].ToString();
                                            string sncd = starr1[1].ToString();
                                            extstr = starr1[2].ToString();
                                            whlexstr = fst + "." + sncd;
                                        }
                                        if (whlstr == "")
                                        {
                                            lnstr = doc_title;
                                        }
                                        else if (whlstr != "")
                                        {
                                            lnstr = whlstr;
                                        }
                                        //string lnstr = "Bell BillInvoice Ref:451646dt:09/11/2010 amt:154.02 party=COMCAST";
                                        //string lnstr = "";


                                        fldindx = lnstr.IndexOf(srchfld);
                                        dtindx = lnstr.IndexOf(srchdt);
                                        amtindx = lnstr.IndexOf(srchamt);
                                        refindx = lnstr.IndexOf(srchref);
                                        prtindx = lnstr.IndexOf(srchprt);
                                        if (amtindx < 0)
                                        {
                                            string srch2amt = "AMT";
                                            amtindx = lnstr.IndexOf(srch2amt);
                                        }
                                        if (refindx < 0)
                                        {
                                            string srch2ref = "REF";
                                            refindx = lnstr.IndexOf(srch2ref);
                                        }
                                        if (dtindx < 0)
                                        {
                                            string srch2dt = "DT";
                                            dtindx = lnstr.IndexOf(srch2dt);
                                        }
                                        if (prtindx < 0)
                                        {
                                            string srch2prt = "PARTY";
                                            prtindx = lnstr.IndexOf(srch2prt);
                                        }
                                        if (fldindx < 0)
                                        {
                                            string srch2fld = "FOLDER";
                                            fldindx = lnstr.IndexOf(srch2fld);
                                        }
                                        if (amtindx < 0)
                                        {
                                            string srch3amt = "amt";
                                            amtindx = lnstr.IndexOf(srch3amt);
                                        }
                                        if (refindx < 0)
                                        {
                                            string srch3ref = "ref";
                                            refindx = lnstr.IndexOf(srch3ref);
                                        }
                                        if (dtindx < 0)
                                        {
                                            string srch3dt = "dt";
                                            dtindx = lnstr.IndexOf(srch3dt);
                                        }
                                        if (prtindx < 0)
                                        {
                                            string srch3prt = "party";
                                            prtindx = lnstr.IndexOf(srch3prt);
                                        }
                                        if (fldindx < 0)
                                        {
                                            string srch3fld = "folder";
                                            fldindx = lnstr.IndexOf(srch3fld);
                                        }
                                        if (fldindx < 0)
                                        {
                                            string srch4fld = "flder";
                                            fldindx = lnstr.IndexOf(srch4fld);
                                        }
                                        if (prtindx < 0)
                                        {
                                            string srch4prt = "prty";
                                            prtindx = lnstr.IndexOf(srch4prt);
                                        }
                                        if (prtindx < 0)
                                        {
                                            string srch5prt = "Prty";
                                            prtindx = lnstr.IndexOf(srch5prt);
                                        }
                                        int amtin1 = amtindx + 4;
                                        int refin1 = refindx + 4;
                                        int dtin1 = dtindx + 3;
                                        int prtin1 = prtindx + 6;
                                        int fldin1 = fldindx + 7;
                                        if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (amtindx < refindx && refindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < fldindx && fldindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < refindx && refindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < dtindx && dtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < refindx && refindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < prtindx && prtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < amtindx && amtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < fldindx && fldindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < amtindx && amtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < amtindx && amtindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < amtindx && amtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < refindx && refindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < amtindx && amtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < refindx && refindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < prtindx && prtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < amtindx && amtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < refindx && refindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < amtindx && amtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < refindx && refindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < dtindx && dtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < refindx && refindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < refindx && refindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < dtindx && dtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < prtindx && prtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < amtindx && amtindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < refindx && refindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < amtindx && amtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < refindx && refindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < prtindx && prtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < refindx && refindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < amtindx && amtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < refindx && refindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < dtindx && dtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx < 0)
                                        {
                                            if (amtindx < refindx && refindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (amtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                        }
                                        if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (amtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();
                                                string[] strSplitArr = folder.Split(separator);

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (refindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, prtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < refindx && refindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < amtindx && amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1).Trim();

                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (amtindx < fldindx && fldindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < amtindx && amtindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < amtindx && amtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < amtindx && amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < prtindx && prtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < amtindx && amtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < amtindx && amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < dtindx && dtindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < fldindx && fldindx < amtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = amtindx - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < amtindx && amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - fldin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                folder = lnstr.Substring(fldin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (fldindx < refindx && refindx < dtindx && dtindx < prtindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < refindx && refindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < dtindx && dtindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (fldindx < prtindx && prtindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                            else if (refindx < fldindx && fldindx < prtindx && prtindx < dtindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < dtindx && dtindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx < prtindx && prtindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < refindx && refindx < prtindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < fldindx && fldindx < prtindx && prtindx < refindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < fldindx && fldindx < prtindx)
                                            {
                                                int diffamt = prtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < refindx && refindx < prtindx && prtindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = prtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx < prtindx && prtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < refindx && refindx < dtindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < fldindx && fldindx < dtindx && dtindx < refindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, fldindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < fldindx && fldindx < dtindx)
                                            {
                                                int diffamt = dtindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < refindx && refindx < dtindx && dtindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = dtindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < refindx && refindx < fldindx)
                                            {
                                                int diffamt = lnstr.Length - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = fldindx - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx < dtindx && dtindx < fldindx && fldindx < refindx)
                                            {
                                                int diffamt = refindx - fldin1;
                                                folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                //string string1 = folder;

                                                //amt = Convert.ToDouble(string1);
                                                int ttlref = lnstr.Length - refin1;
                                                if (ttlref > 10)
                                                {
                                                    ttlref = 10;
                                                }
                                                refst = lnstr.Substring(refin1, ttlref);
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        else if (amtindx >= 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0 && fldindx < 0)
                                        {
                                            if (amtindx < refindx)
                                            {
                                                if (amtindx < dtindx)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > dtindx)
                                                {
                                                    int diffamt = refindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    int ttldat = amtindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > refindx)
                                            {
                                                if (amtindx < dtindx)
                                                {
                                                    int diffamt = dtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, amtindx - refin1);
                                                    string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (amtindx > dtindx)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        refst = lnstr.Substring(refin1, dtindx - refin1);
                                                        int ttldat = amtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = amtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx >= 0 && fldindx < 0)
                                        {
                                            if (amtindx < refindx)
                                            {
                                                if (amtindx < prtindx)
                                                {
                                                    if (refindx < prtindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx > prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > prtindx)
                                                {
                                                    int diffamt = refindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > refindx)
                                            {
                                                if (amtindx < prtindx)
                                                {
                                                    int diffamt = prtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, amtindx - refin1);
                                                    party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (amtindx > prtindx)
                                                {
                                                    if (refindx < prtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        refst = lnstr.Substring(refin1, prtindx - refin1);
                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > prtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx >= 0 && fldindx < 0)
                                        {
                                            if (amtindx < dtindx)
                                            {
                                                if (amtindx < prtindx)
                                                {
                                                    if (dtindx < prtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else if (dtindx > prtindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        int ttldat = lnstr.Length - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }

                                                }
                                                else if (amtindx > prtindx)
                                                {
                                                    int diffamt = dtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    int ttldat = lnstr.Length - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > dtindx)
                                            {
                                                if (amtindx < prtindx)
                                                {
                                                    int diffamt = prtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    int ttldat = amtindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                    mainstr = lnstr.Remove(dtindx).Trim();
                                                }
                                                else if (amtindx > prtindx)
                                                {
                                                    if (dtindx < prtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx > prtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx >= 0 && fldindx < 0)
                                        {
                                            if (refindx < dtindx)
                                            {
                                                if (refindx < prtindx)
                                                {
                                                    if (dtindx < prtindx)
                                                    {
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else if (dtindx > prtindx)
                                                    {

                                                        int ttlref = prtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        int ttldat = lnstr.Length - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                }
                                                else if (refindx > prtindx)
                                                {

                                                    int ttlref = dtindx - refin1;
                                                    if (ttlref > 10)
                                                    {
                                                        ttlref = 10;
                                                    }
                                                    refst = lnstr.Substring(refin1, ttlref);
                                                    int ttldat = lnstr.Length - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                    mainstr = lnstr.Remove(prtindx).Trim();
                                                }
                                            }
                                            else if (refindx > dtindx)
                                            {
                                                if (refindx < prtindx)
                                                {

                                                    int ttlref = prtindx - refin1;
                                                    if (ttlref > 10)
                                                    {
                                                        ttlref = 10;
                                                    }
                                                    refst = lnstr.Substring(refin1, ttlref);
                                                    int ttldat = refindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                    mainstr = lnstr.Remove(dtindx).Trim();
                                                }
                                                else if (refindx > prtindx)
                                                {
                                                    if (dtindx < prtindx)
                                                    {

                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, refindx - prtin1).Trim();


                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                    else if (dtindx > prtindx)
                                                    {
                                                        int ttlref = lnstr.Length - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                            }


                                        }
                                        else if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (amtindx < refindx)
                                            {
                                                if (amtindx < fldindx)
                                                {
                                                    if (refindx < fldindx)
                                                    {
                                                        int diffamt = refindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        //dat = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (refindx > fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = refindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        //dat = lnstr.Substring(fldin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > fldindx)
                                                {
                                                    int diffamt = refindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    int ttldat = amtindx - fldin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    folder = lnstr.Substring(fldin1, ttldat).Trim();


                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > refindx)
                                            {
                                                if (amtindx < fldindx)
                                                {
                                                    int diffamt = fldindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    refst = lnstr.Substring(refin1, amtindx - refin1);
                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();


                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (amtindx > fldindx)
                                                {
                                                    if (refindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        refst = lnstr.Substring(refin1, fldindx - refin1);
                                                        int ttldat = amtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();


                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (amtindx < fldindx)
                                            {
                                                if (amtindx < dtindx)
                                                {
                                                    if (fldindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (fldindx > dtindx)
                                                    {
                                                        int diffamt = dtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > dtindx)
                                                {
                                                    int diffamt = fldindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);
                                                    int ttldat = amtindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > fldindx)
                                            {
                                                if (amtindx < dtindx)
                                                {
                                                    int diffamt = dtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    folder = lnstr.Substring(fldin1, amtindx - fldin1);
                                                    string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(fldindx).Trim();
                                                }
                                                else if (amtindx > dtindx)
                                                {
                                                    if (fldindx < dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1);
                                                        int ttldat = amtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx > dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                }
                                            }

                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (fldindx < refindx)
                                            {
                                                if (fldindx < dtindx)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        int diffamt = refindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        int diffamt = dtindx - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                                else if (fldindx > dtindx)
                                                {
                                                    int diffamt = refindx - fldin1;
                                                    folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    int ttldat = fldindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(fldindx).Trim();
                                                }
                                            }
                                            else if (fldindx > refindx)
                                            {
                                                if (fldindx < dtindx)
                                                {
                                                    int diffamt = dtindx - fldin1;
                                                    folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                    refst = lnstr.Substring(refin1, fldindx - refin1);
                                                    string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (fldindx > dtindx)
                                                {
                                                    if (refindx < dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();

                                                        refst = lnstr.Substring(refin1, dtindx - refin1);
                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - fldin1;
                                                        folder = lnstr.Substring(fldin1, diffamt).Trim();
                                                        string string1 = folder;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = dtindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                }
                                            }
                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (amtindx < prtindx)
                                            {
                                                if (amtindx < fldindx)
                                                {
                                                    if (prtindx < fldindx)
                                                    {
                                                        int diffamt = prtindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - prtin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        party = lnstr.Substring(prtin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        //dat = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                    else if (prtindx > fldindx)
                                                    {
                                                        int diffamt = fldindx - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttldat = prtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        //dat = lnstr.Substring(fldin1, ttldat).Trim();
                                                        party = lnstr.Substring(prtin1, lnstr.Length - prtin1);

                                                        mainstr = lnstr.Remove(amtindx).Trim();
                                                    }
                                                }
                                                else if (amtindx > fldindx)
                                                {
                                                    int diffamt = prtindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    party = lnstr.Substring(prtin1, lnstr.Length - prtin1);
                                                    int ttldat = amtindx - fldin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                    mainstr = lnstr.Remove(amtindx).Trim();
                                                }
                                            }
                                            else if (amtindx > prtindx)
                                            {
                                                if (amtindx < fldindx)
                                                {
                                                    int diffamt = fldindx - amtin1;
                                                    string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                    string string1 = trmamt;

                                                    amt = Convert.ToDouble(string1);
                                                    party = lnstr.Substring(prtin1, amtindx - prtin1);
                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                    mainstr = lnstr.Remove(prtindx).Trim();
                                                }
                                                else if (amtindx > fldindx)
                                                {
                                                    if (prtindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        party = lnstr.Substring(prtin1, fldindx - prtin1);
                                                        int ttldat = amtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (prtindx > fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - amtin1;
                                                        string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                        string string1 = trmamt;

                                                        amt = Convert.ToDouble(string1);
                                                        int ttlref = fldindx - prtin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        party = lnstr.Substring(prtin1, ttlref);
                                                        int ttldat = prtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                            }
                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (prtindx < refindx)
                                            {
                                                if (prtindx < fldindx)
                                                {
                                                    if (refindx < fldindx)
                                                    {
                                                        int diffamt = refindx - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                        //dat = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (refindx > fldindx)
                                                    {
                                                        int diffamt = fldindx - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttldat = refindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        //dat = lnstr.Substring(fldin1, ttldat).Trim();
                                                        refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                else if (prtindx > fldindx)
                                                {
                                                    int diffamt = refindx - prtin1;
                                                    party = lnstr.Substring(prtin1, diffamt).Trim();

                                                    refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                    int ttldat = prtindx - fldin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                    mainstr = lnstr.Remove(prtindx).Trim();
                                                }
                                            }
                                            else if (prtindx > refindx)
                                            {
                                                if (prtindx < fldindx)
                                                {
                                                    int diffamt = fldindx - prtin1;
                                                    party = lnstr.Substring(prtin1, diffamt).Trim();

                                                    refst = lnstr.Substring(refin1, prtindx - refin1);
                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();


                                                    mainstr = lnstr.Remove(refindx).Trim();
                                                }
                                                else if (prtindx > fldindx)
                                                {
                                                    if (refindx < fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        refst = lnstr.Substring(refin1, fldindx - refin1);
                                                        int ttldat = prtindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();


                                                        mainstr = lnstr.Remove(refindx).Trim();
                                                    }
                                                    else if (refindx > fldindx)
                                                    {
                                                        int diffamt = lnstr.Length - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttlref = fldindx - refin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        refst = lnstr.Substring(refin1, ttlref);
                                                        int ttldat = refindx - fldin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttldat).Trim();

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                }
                                            }
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx >= 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (prtindx < fldindx)
                                            {
                                                if (prtindx < dtindx)
                                                {
                                                    if (fldindx < dtindx)
                                                    {
                                                        int diffamt = fldindx - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                    else if (fldindx > dtindx)
                                                    {
                                                        int diffamt = dtindx - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }
                                                        //dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                        mainstr = lnstr.Remove(prtindx).Trim();
                                                    }
                                                }
                                                else if (prtindx > dtindx)
                                                {
                                                    int diffamt = fldindx - prtin1;
                                                    party = lnstr.Substring(prtin1, diffamt).Trim();

                                                    folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);
                                                    int ttldat = prtindx - dtin1;
                                                    if (ttldat > 10)
                                                    {
                                                        ttldat = 10;
                                                    }
                                                    string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(prtindx).Trim();
                                                }
                                            }
                                            else if (prtindx > fldindx)
                                            {
                                                if (prtindx < dtindx)
                                                {
                                                    int diffamt = dtindx - prtin1;
                                                    party = lnstr.Substring(prtin1, diffamt).Trim();

                                                    folder = lnstr.Substring(fldin1, prtindx - fldin1);
                                                    string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    string[] strSplitArr = dttmp.Split(separator);
                                                    int i1 = Convert.ToInt32(strSplitArr.Length);
                                                    if (i1 == 3)
                                                    {
                                                        dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                    }
                                                    else
                                                    {
                                                        dat = "";
                                                    }

                                                    mainstr = lnstr.Remove(fldindx).Trim();
                                                }
                                                else if (prtindx > dtindx)
                                                {
                                                    if (fldindx < dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        folder = lnstr.Substring(fldin1, dtindx - fldin1);
                                                        int ttldat = prtindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(fldindx).Trim();
                                                    }
                                                    else if (fldindx > dtindx)
                                                    {
                                                        int diffamt = lnstr.Length - prtin1;
                                                        party = lnstr.Substring(prtin1, diffamt).Trim();

                                                        int ttlref = dtindx - fldin1;
                                                        if (ttlref > 10)
                                                        {
                                                            ttlref = 10;
                                                        }
                                                        folder = lnstr.Substring(fldin1, ttlref);
                                                        int ttldat = fldindx - dtin1;
                                                        if (ttldat > 10)
                                                        {
                                                            ttldat = 10;
                                                        }
                                                        string dttmp = lnstr.Substring(dtin1, ttldat).Trim();
                                                        string[] strSplitArr = dttmp.Split(separator);
                                                        int i1 = Convert.ToInt32(strSplitArr.Length);
                                                        if (i1 == 3)
                                                        {
                                                            dat = lnstr.Substring(dtin1, ttldat).Trim();
                                                        }
                                                        else
                                                        {
                                                            dat = "";
                                                        }

                                                        mainstr = lnstr.Remove(dtindx).Trim();
                                                    }
                                                }
                                            }
                                        }
                                        else if (amtindx >= 0 && refindx >= 0 && dtindx < 0 && prtindx < 0)
                                        {
                                            if (amtindx < refindx)
                                            {
                                                int diffamt = refindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx > refindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                refst = lnstr.Substring(refin1, amtindx - refin1);

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx >= 0 && prtindx < 0)
                                        {
                                            if (amtindx < dtindx)
                                            {
                                                int diffamt = dtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx > dtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                string dttmp = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, amtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx >= 0 && prtindx < 0)
                                        {
                                            if (refindx < dtindx)
                                            {
                                                refst = lnstr.Substring(refin1, dtindx - refin1).Trim();
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx > dtindx)
                                            {
                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);

                                                string dttmp = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, refindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                        }
                                        else if (amtindx >= 0 && prtindx >= 0 && refindx < 0 && dtindx < 0)
                                        {
                                            if (amtindx < prtindx)
                                            {
                                                int diffamt = prtindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx > prtindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                party = lnstr.Substring(prtin1, amtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && prtindx >= 0 && refindx >= 0 && dtindx < 0)
                                        {
                                            if (refindx < prtindx)
                                            {

                                                refst = lnstr.Substring(refin1, prtindx - refin1);
                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx > prtindx)
                                            {

                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                party = lnstr.Substring(prtin1, refindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && prtindx >= 0 && refindx < 0 && dtindx >= 0)
                                        {
                                            if (dtindx < prtindx)
                                            {
                                                string dttmp = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, prtindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx > prtindx)
                                            {
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                party = lnstr.Substring(prtin1, dtindx - prtin1).Trim();

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx < 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            if (amtindx < fldindx)
                                            {
                                                int diffamt = fldindx - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                mainstr = lnstr.Remove(amtindx).Trim();
                                            }
                                            else if (amtindx > fldindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                                string string1 = trmamt;

                                                amt = Convert.ToDouble(string1);
                                                folder = lnstr.Substring(fldin1, amtindx - fldin1);

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && prtindx < 0 && refindx >= 0 && dtindx < 0 && fldindx >= 0)
                                        {
                                            if (refindx < fldindx)
                                            {

                                                refst = lnstr.Substring(refin1, fldindx - refin1);
                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(refindx).Trim();
                                            }
                                            else if (refindx > prtindx)
                                            {

                                                refst = lnstr.Substring(refin1, lnstr.Length - refin1);
                                                folder = lnstr.Substring(fldin1, refindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }

                                        }
                                        else if (amtindx < 0 && prtindx < 0 && refindx < 0 && dtindx >= 0 && fldindx >= 0)
                                        {
                                            if (dtindx < fldindx)
                                            {
                                                string dttmp = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, fldindx - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }

                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                                mainstr = lnstr.Remove(dtindx).Trim();
                                            }
                                            else if (dtindx > fldindx)
                                            {
                                                string dttmp = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                string[] strSplitArr = dttmp.Split(separator);
                                                int i1 = Convert.ToInt32(strSplitArr.Length);
                                                if (i1 == 3)
                                                {
                                                    dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();
                                                }
                                                else
                                                {
                                                    dat = "";
                                                }
                                                folder = lnstr.Substring(fldin1, dtindx - fldin1).Trim();

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx < 0 && prtindx >= 0 && fldindx >= 0)
                                        {
                                            if (prtindx < fldindx)
                                            {
                                                int diffamt = fldindx - prtin1;
                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                folder = lnstr.Substring(fldin1, lnstr.Length - fldin1);

                                                mainstr = lnstr.Remove(prtindx).Trim();
                                            }
                                            else if (prtindx > fldindx)
                                            {
                                                int diffamt = lnstr.Length - amtin1;
                                                party = lnstr.Substring(prtin1, diffamt).Trim();

                                                folder = lnstr.Substring(fldin1, prtindx - fldin1);

                                                mainstr = lnstr.Remove(fldindx).Trim();
                                            }

                                        }
                                        else if (amtindx >= 0 && refindx < 0 && dtindx < 0 && prtindx < 0)
                                        {
                                            int diffamt = lnstr.Length - amtin1;
                                            string trmamt = lnstr.Substring(amtin1, diffamt).Trim();
                                            string string1 = trmamt;

                                            amt = Convert.ToDouble(string1);

                                            mainstr = lnstr.Remove(amtindx).Trim();
                                        }
                                        else if (amtindx < 0 && refindx >= 0 && dtindx < 0 && prtindx < 0)
                                        {
                                            refst = lnstr.Substring(refin1, lnstr.Length - refin1).Trim();

                                            mainstr = lnstr.Remove(refindx).Trim();
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx >= 0 && prtindx < 0)
                                        {
                                            dat = lnstr.Substring(dtin1, lnstr.Length - dtin1).Trim();

                                            mainstr = lnstr.Remove(dtindx).Trim();
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx < 0 && prtindx >= 0)
                                        {
                                            party = lnstr.Substring(prtin1, lnstr.Length - prtin1).Trim();

                                            mainstr = lnstr.Remove(prtindx).Trim();
                                        }
                                        else if (amtindx < 0 && refindx < 0 && dtindx < 0 && prtindx < 0 && fldindx >= 0)
                                        {
                                            folder = lnstr.Substring(fldin1, lnstr.Length - fldin1).Trim();

                                            mainstr = lnstr.Remove(fldindx).Trim();
                                        }



                                        if (folder != "" && party != "")
                                        {
                                            DataTable dtminprt = new DataTable();
                                            dtminprt = clsDocument.SelectFolderName(folder, ddlbusiness.SelectedValue);
                                            if (dtminprt.Rows.Count > 0)
                                            {
                                                if (dtminprt.Rows[0]["FolderName"] != System.DBNull.Value && dtminprt.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                {
                                                    folderid = Convert.ToInt32(dtminprt.Rows[0][0].ToString());
                                                    Docnam = dtminprt.Rows[0][1].ToString();

                                                    if (Docnam == folder.ToUpper())
                                                    {
                                                        //Docnam = folder;
                                                    }
                                                    else
                                                    {
                                                        DataTable dtgen = new DataTable();
                                                        dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                        if (dtgen.Rows.Count > 0)
                                                        {
                                                            if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                            {
                                                                ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                            }
                                                        }
                                                        if (ign == 0)
                                                        {
                                                            DataTable dtdocsubid = new DataTable();
                                                            dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                            if (dtdocsubid.Rows.Count > 0)
                                                            {
                                                                if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                                {
                                                                    i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                                }
                                                            }

                                                            if (i34 == 0)
                                                            {
                                                                DataTable dtcab = new DataTable();
                                                                dtcab = clsDocument.SelectGeneralCabinetId();
                                                                if (dtcab.Rows.Count > 0)
                                                                {
                                                                    if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                                    {
                                                                        ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                                    }
                                                                }
                                                                if (ica == 0)
                                                                {
                                                                    Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                                    if (rst > 0)
                                                                    {
                                                                        Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                        if (rst1 > 0)
                                                                        {
                                                                            Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                            if (rst2 > 0)
                                                                            {
                                                                                folderid = rst2;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                                    if (rst1 > 0)
                                                                    {
                                                                        Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                        if (rst2 > 0)
                                                                        {
                                                                            folderid = rst2;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                                if (rst2 > 0)
                                                                {
                                                                    folderid = rst2;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            folderid = ign;
                                                        }
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                //Int32 i = 0;
                                                DataTable dtgen = new DataTable();
                                                dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                if (dtgen.Rows.Count > 0)
                                                {
                                                    if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                    {
                                                        ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                    }
                                                }
                                                if (ign == 0)
                                                {
                                                    DataTable dtdocsubid = new DataTable();
                                                    dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                    if (dtdocsubid.Rows.Count > 0)
                                                    {
                                                        if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                        {
                                                            i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                        }
                                                    }
                                                    if (i34 == 0)
                                                    {
                                                        DataTable dtcab = new DataTable();
                                                        dtcab = clsDocument.SelectGeneralCabinetId();
                                                        if (dtcab.Rows.Count > 0)
                                                        {
                                                            if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                            {
                                                                ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                            }
                                                        }
                                                        if (ica == 0)
                                                        {
                                                            Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                            if (rst > 0)
                                                            {
                                                                Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                if (rst1 > 0)
                                                                {
                                                                    Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                    if (rst2 > 0)
                                                                    {
                                                                        folderid = rst2;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                            if (rst1 > 0)
                                                            {
                                                                Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                if (rst2 > 0)
                                                                {
                                                                    folderid = rst2;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                        if (rst2 > 0)
                                                        {
                                                            folderid = rst2;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    folderid = ign;
                                                }
                                            }
                                            DataTable dtminprt1 = new DataTable();
                                            dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMaster(party, ddlbusiness.SelectedValue);
                                            if (dtminprt1.Rows.Count > 0)
                                            {
                                                if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                {
                                                    prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                }
                                            }
                                            if (prtid == 0)
                                            {
                                                if (party != "")
                                                {
                                                    EmployeeCls clsEmployee = new EmployeeCls();
                                                    clsMaster = new MasterCls();
                                                    //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                    //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, party, "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                    //Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                    //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                    prtid = UserEntry();
                                                    //prtid = partyid;
                                                }
                                                else
                                                {
                                                    DataTable dtminprt12 = new DataTable();
                                                    dtminprt12 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                    if (dtminprt1.Rows.Count > 0)
                                                    {
                                                        if (dtminprt12.Rows[0]["PartyId"] != System.DBNull.Value)
                                                        {
                                                            prtid = Convert.ToInt32(dtminprt12.Rows[0][0].ToString());
                                                        }
                                                    }
                                                    if (prtid == 0)
                                                    {
                                                        //EmployeeCls clsEmployee = new EmployeeCls();
                                                        //clsMaster = new MasterCls();
                                                        //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                        //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                        //Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                        //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                        prtid = UserEntry();
                                                        //prtid = partyid;
                                                    }
                                                }
                                            }
                                        }
                                        else if (folder != "" && party == "")
                                        {
                                            DataTable dtminprt = new DataTable();
                                            dtminprt = clsDocument.SelectFolderName(folder, ddlbusiness.SelectedValue);
                                            if (dtminprt.Rows.Count > 0)
                                            {
                                                if (dtminprt.Rows[0]["FolderName"] != System.DBNull.Value && dtminprt.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                {
                                                    folderid = Convert.ToInt32(dtminprt.Rows[0][0].ToString());
                                                    Docnam = dtminprt.Rows[0][1].ToString();

                                                    if (folderid > 0)
                                                    {
                                                        DataTable dtprtfmfld = new DataTable();
                                                        dtprtfmfld = clsDocument.SelectPartyIdFromFolderID(folderid);
                                                        if (dtprtfmfld.Rows.Count > 0)
                                                        {
                                                            if (dtprtfmfld.Rows[0]["PartyId"] != System.DBNull.Value)
                                                            {
                                                                prtid = Convert.ToInt32(dtprtfmfld.Rows[0]["PartyId"].ToString());
                                                            }
                                                            if (dtprtfmfld.Rows[0]["Folderdefaultparty"] != System.DBNull.Value)
                                                            {
                                                                bool dfltprt = Convert.ToBoolean(dtprtfmfld.Rows[0]["Folderdefaultparty"].ToString());
                                                            }
                                                        }
                                                        if (prtid == 0 || prtid < 0)
                                                        {
                                                            DataTable dtminprt1 = new DataTable();
                                                            dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                            if (dtminprt1.Rows.Count > 0)
                                                            {
                                                                if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                                {
                                                                    prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                                }
                                                            }
                                                            if (prtid == 0)
                                                            {
                                                                EmployeeCls clsEmployee = new EmployeeCls();
                                                                clsMaster = new MasterCls();
                                                                //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                                //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                                //Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                                //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                                prtid = UserEntry();
                                                                //prtid = partyid;
                                                            }

                                                        }
                                                        //Docnam = folder;
                                                    }
                                                    else
                                                    {
                                                        //Int32 i = 0;
                                                        DataTable dtgen = new DataTable();
                                                        dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                        if (dtgen.Rows.Count > 0)
                                                        {
                                                            if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                            {
                                                                ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                            }
                                                        }
                                                        if (ign == 0)
                                                        {
                                                            DataTable dtdocsubid = new DataTable();
                                                            dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                            if (dtdocsubid.Rows.Count > 0)
                                                            {
                                                                if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                                {
                                                                    i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                                }
                                                            }
                                                            if (i34 == 0)
                                                            {
                                                                DataTable dtcab = new DataTable();
                                                                dtcab = clsDocument.SelectGeneralCabinetId();
                                                                if (dtcab.Rows.Count > 0)
                                                                {
                                                                    if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                                    {
                                                                        ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                                    }
                                                                }
                                                                if (ica == 0)
                                                                {
                                                                    Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                                    if (rst > 0)
                                                                    {
                                                                        Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                        if (rst1 > 0)
                                                                        {
                                                                            Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                            if (rst2 > 0)
                                                                            {
                                                                                folderid = rst2;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                                    if (rst1 > 0)
                                                                    {
                                                                        Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                        if (rst2 > 0)
                                                                        {
                                                                            folderid = rst2;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                                if (rst2 > 0)
                                                                {
                                                                    folderid = rst2;
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            folderid = ign;
                                                        }

                                                        DataTable dtminprt1 = new DataTable();
                                                        dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                        if (dtminprt1.Rows.Count > 0)
                                                        {
                                                            if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                            {
                                                                prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                            }
                                                        }
                                                        if (prtid == 0)
                                                        {
                                                            EmployeeCls clsEmployee = new EmployeeCls();
                                                            clsMaster = new MasterCls();
                                                            //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                            //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                            //Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                            //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                            prtid = UserEntry();
                                                            //prtid = partyid;
                                                        }
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                //Int32 i = 0;
                                                DataTable dtgen = new DataTable();
                                                dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                if (dtgen.Rows.Count > 0)
                                                {
                                                    if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                    {
                                                        ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                    }
                                                }
                                                if (ign == 0)
                                                {
                                                    DataTable dtdocsubid = new DataTable();
                                                    dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                    if (dtdocsubid.Rows.Count > 0)
                                                    {
                                                        if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                        {
                                                            i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                        }
                                                    }
                                                    if (i34 == 0)
                                                    {
                                                        DataTable dtcab = new DataTable();
                                                        dtcab = clsDocument.SelectGeneralCabinetId();
                                                        if (dtcab.Rows.Count > 0)
                                                        {
                                                            if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                            {
                                                                ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                            }
                                                        }
                                                        if (ica == 0)
                                                        {
                                                            Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                            if (rst > 0)
                                                            {
                                                                Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                if (rst1 > 0)
                                                                {
                                                                    Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                    if (rst2 > 0)
                                                                    {
                                                                        folderid = rst2;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                            if (rst1 > 0)
                                                            {
                                                                Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                if (rst2 > 0)
                                                                {
                                                                    folderid = rst2;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                        if (rst2 > 0)
                                                        {
                                                            folderid = rst2;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    folderid = ign;
                                                }

                                                DataTable dtminprt1 = new DataTable();
                                                dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                if (dtminprt1.Rows.Count > 0)
                                                {
                                                    if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                    {
                                                        prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                    }
                                                }
                                                if (prtid == 0)
                                                {
                                                    //EmployeeCls clsEmployee = new EmployeeCls();
                                                    //clsMaster = new MasterCls();
                                                    //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                    //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                    ////Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                    //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                    prtid = UserEntry();
                                                    //prtid = partyid;
                                                }
                                            }
                                        }
                                        else if (folder == "" && party != "")
                                        {
                                            DataTable dtminprt = new DataTable();
                                            dtminprt = clsDocument.SelectMinPartyIdfromPartyMaster(party, ddlbusiness.SelectedValue);
                                            if (dtminprt.Rows.Count > 0)
                                            {
                                                if (dtminprt.Rows[0]["PartyId"] != System.DBNull.Value)
                                                {
                                                    prtid = Convert.ToInt32(dtminprt.Rows[0][0].ToString());
                                                }
                                                if (prtid > 0)
                                                {
                                                    DataTable dtfldfmprt = new DataTable();
                                                    dtfldfmprt = clsDocument.SelectFolderIdFromPartyID(prtid);
                                                    if (dtfldfmprt.Rows.Count > 0)
                                                    {
                                                        if (dtfldfmprt.Rows[0]["FolderId"] != System.DBNull.Value)
                                                        {
                                                            folderid = Convert.ToInt32(dtfldfmprt.Rows[0]["FolderId"].ToString());
                                                        }

                                                        //bool Partydefaultfolder = true;
                                                        //bool Folderdefaultparty = false;
                                                        //Int32 prtfld = clsMaster.insertPartyFolderRelation1(Convert.ToString(prtid), folderid, Partydefaultfolder, Folderdefaultparty);
                                                    }
                                                }
                                            }
                                            if (prtid == 0)
                                            {
                                                if (party != "")
                                                {
                                                    //EmployeeCls clsEmployee = new EmployeeCls();
                                                    //clsMaster = new MasterCls();
                                                    //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                    //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, party, "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                    ////Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                    //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                    prtid = UserEntry();
                                                    //prtid = partyid;

                                                }
                                                else
                                                {
                                                    DataTable dtminprt1 = new DataTable();
                                                    dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                                    if (dtminprt1.Rows.Count > 0)
                                                    {
                                                        if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                        {
                                                            prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                        }
                                                    }
                                                    if (prtid == 0)
                                                    {
                                                        //EmployeeCls clsEmployee = new EmployeeCls();
                                                        //clsMaster = new MasterCls();
                                                        //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                        //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, party, "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                        ////Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                        //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                        prtid = UserEntry();
                                                        //prtid = partyid;
                                                    }
                                                }
                                            }
                                            if (folderid == 0)
                                            {
                                                //Int32 i = 0;
                                                DataTable dtgen = new DataTable();
                                                dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                                if (dtgen.Rows.Count > 0)
                                                {
                                                    if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                    {
                                                        ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                    }
                                                }
                                                if (ign == 0)
                                                {
                                                    DataTable dtdocsubid = new DataTable();
                                                    dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                    if (dtdocsubid.Rows.Count > 0)
                                                    {
                                                        if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                        {
                                                            i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                        }
                                                    }
                                                    if (i34 == 0)
                                                    {
                                                        DataTable dtcab = new DataTable();
                                                        dtcab = clsDocument.SelectGeneralCabinetId();
                                                        if (dtcab.Rows.Count > 0)
                                                        {
                                                            if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                            {
                                                                ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                            }
                                                        }
                                                        if (ica == 0)
                                                        {
                                                            Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                            if (rst > 0)
                                                            {
                                                                Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                                if (rst1 > 0)
                                                                {
                                                                    Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                    if (rst2 > 0)
                                                                    {
                                                                        folderid = rst2;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                            if (rst1 > 0)
                                                            {
                                                                Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                if (rst2 > 0)
                                                                {
                                                                    folderid = rst2;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                        if (rst2 > 0)
                                                        {
                                                            folderid = rst2;
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    folderid = ign;
                                                }
                                            }
                                        }
                                        else if (folder == "" && party == "")
                                        {
                                            DataTable dtgen = new DataTable();
                                            dtgen = clsDocument.SelectGeneralFolderId(ddlbusiness.SelectedValue);
                                            if (dtgen.Rows.Count > 0)
                                            {
                                                if (dtgen.Rows[0]["DocumentTypeId"] != System.DBNull.Value)
                                                {
                                                    ign = Convert.ToInt32(dtgen.Rows[0]["DocumentTypeId"].ToString());
                                                }
                                            }
                                            if (ign == 0)
                                            {
                                                DataTable dtdocsubid = new DataTable();
                                                dtdocsubid = clsDocument.SelectMaxDocumentSubIdfromDocumentSubType("General", ddlbusiness.SelectedValue);
                                                if (dtdocsubid.Rows.Count > 0)
                                                {
                                                    if (dtdocsubid.Rows[0]["DocumentSubTypeId"] != System.DBNull.Value)
                                                    {
                                                        i34 = Convert.ToInt32(dtdocsubid.Rows[0]["DocumentSubTypeId"].ToString());
                                                    }
                                                }
                                                if (i34 == 0)
                                                {
                                                    DataTable dtcab = new DataTable();
                                                    dtcab = clsDocument.SelectGeneralCabinetId();
                                                    if (dtcab.Rows.Count > 0)
                                                    {
                                                        if (dtcab.Rows[0]["DocumentMainTypeId"] != System.DBNull.Value)
                                                        {
                                                            ica = Convert.ToInt32(dtcab.Rows[0]["DocumentMainTypeId"].ToString());
                                                        }
                                                    }
                                                    if (ica == 0)
                                                    {
                                                        Int32 rst = clsDocument.InsertDocumentMainType("General", ddlbusiness.SelectedValue);
                                                        if (rst > 0)
                                                        {
                                                            Int32 rst1 = clsDocument.InsertDocumentSubType(rst, "General");
                                                            if (rst1 > 0)
                                                            {
                                                                Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                                if (rst2 > 0)
                                                                {
                                                                    folderid = rst2;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        Int32 rst1 = clsDocument.InsertDocumentSubType(ica, "General");
                                                        if (rst1 > 0)
                                                        {
                                                            Int32 rst2 = clsDocument.InsertDocumentType1(rst1, "General");
                                                            if (rst2 > 0)
                                                            {
                                                                folderid = rst2;
                                                            }
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    Int32 rst2 = clsDocument.InsertDocumentType1(i34, "General");
                                                    if (rst2 > 0)
                                                    {
                                                        folderid = rst2;
                                                    }
                                                }                                            //Int32 rst = clsDocument.InsertDocumentType1(i34, folder);
                                            }
                                            else
                                            {

                                                folderid = ign;
                                            }
                                            bool prychk = false;
                                            bool fldchk = false;
                                            DataTable dtminprt1 = new DataTable();
                                            dtminprt1 = clsDocument.SelectMinPartyIdfromPartyMasterName(ddlbusiness.SelectedValue);
                                            if (dtminprt1.Rows.Count > 0)
                                            {
                                                if (dtminprt1.Rows[0]["PartyId"] != System.DBNull.Value)
                                                {
                                                    prtid = Convert.ToInt32(dtminprt1.Rows[0][0].ToString());
                                                }
                                            }
                                            if (prtid == 0)
                                            {

                                                EmployeeCls clsEmployee = new EmployeeCls();
                                                clsMaster = new MasterCls();
                                                //Int32 AccountId = clsMaster.InsertAccountMasterParty(1, 1, "test", "", System.DateTime.Today.ToShortDateString(), "0");
                                                //Int32 partyid = clsMaster.InsertPartyMaster(2, AccountId, 1, "GENERAL", "Na", "1223", 0, 0, 0, 0, "4556", "");
                                                ////Int32 rst32 = clsMaster.InsertPartyAddressDetail(partyid, 1, "CANADA", "NA", "10", "", "", "", "", "", "", "");
                                                //Int32 securityansid = clsEmployee.InsertSecurityAnsEntry(1, partyid, "Pink");
                                                prtid = UserEntry();
                                                //prtid = partyid;
                                            }

                                        }


                                        //doc_title = mainstr;
                                    }
                                    else
                                    {
                                        //string filename1 = f.Name;

                                        doc_title = Convert.ToString(doc_email_down.Rows[0]["DocumentTittle"].ToString());

                                    }
                                    if (doc_email_down.Rows[0]["DocumentEmailDownloadDefaultPropId"] != System.DBNull.Value)
                                    {

                                        if (doc_email_down.Rows[0]["DocumentEmailDownloadDefaultPropId"].ToString() == "")
                                        {
                                            Int32 rst45 = 0;
                                            // string filename1 = f.Name;
                                            //DocId = clsDocument.InsertDocumentMaster(DocTypeId, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), filename1 , DocDesc, PartyId, "", 0, Convert.ToInt32(Session["EmployeeId"].ToString()));
                                            if (dat != "")
                                            {
                                                if (prtid == 0)
                                                {
                                                    rst45 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(dat), extstr);
                                                    imagefo(filename1, rst45);
                                                }
                                                else if (prtid > 0)
                                                {
                                                    rst45 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(dat), extstr);
                                                    imagefo(filename1, rst45);
                                                }
                                            }
                                            else
                                            {
                                                if (prtid == 0)
                                                {
                                                    rst45 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(System.DateTime.Now.ToString()), extstr);
                                                    imagefo(filename1, rst45);
                                                }
                                                else if (prtid > 0)
                                                {
                                                    rst45 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(System.DateTime.Now.ToString()), extstr);
                                                    imagefo(filename1, rst45);
                                                }
                                            }
                                            //Int32 rst = clsDocument.InsertDocumentMaster(DocumentTypeId, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, partyid, refst,amt, 1);
                                            // *** ADDed Code  ** //
                                            //docautoapprove = true;
                                            if (rst45 > 0)
                                            {
                                                if (docautoapprove == true)
                                                {
                                                    //string docaprv = "select max(DocumentId) from DocumentMaster";
                                                    DataTable dtdcap = new DataTable();
                                                    dtdcap = clsDocument.SelectMaxDocumentIdfromDocumentMaster();
                                                    bool dcaprv = docautoapprove;
                                                    //Int32 indcapr = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), Convert.ToInt32(dtdcap.Rows[0]["DocumentId"].ToString()));
                                                    bool indc = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), Convert.ToInt32(dtdcap.Rows[0]["DocumentId"].ToString()), docautoapprove);

                                                }
                                            }
                                            // upto this added code ///
                                            //File.SetAttributes(location + f.Name, FileAttributes.Hidden);
                                            //doc_title = mainstr;
                                        }
                                        else if (doc_email_down.Rows[0]["DocumentEmailDownloadDefaultPropId"].ToString() != "")
                                        {
                                            Int32 rst = 0;
                                            if (dat != "")
                                            {
                                                rst = clsDocument.InsertDocumentMaster(DocumentTypeId7, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title7, doc_email_desc7, partyid17, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(dat), extstr);
                                                imagefo(filename1, rst);
                                            }
                                            else
                                            {
                                                rst = clsDocument.InsertDocumentMaster(DocumentTypeId7, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title7, doc_email_desc7, partyid17, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(System.DateTime.Now.ToString()), extstr);
                                                imagefo(filename1, rst);
                                            }

                                            //Int32 rst = clsDocument.InsertDocumentMaster(0, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), filename1, filename, 0,refst,amt, 1);
                                            // *** ADDed Code  ** //
                                            if (rst > 0)
                                            {
                                                if (docautoapprove == true)
                                                {
                                                    //string docaprv = "select max(DocumentId) from DocumentMaster";
                                                    DataTable dtdcap = new DataTable();
                                                    dtdcap = clsDocument.SelectMaxDocumentIdfromDocumentMaster();
                                                    bool dcaprv = docautoapprove;
                                                    //Int32 indcapr = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), Convert.ToInt32(dtdcap.Rows[0]["DocumentId"].ToString()));
                                                    bool indc = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), Convert.ToInt32(dtdcap.Rows[0]["DocumentId"].ToString()), docautoapprove);

                                                }
                                            }
                                            // upto this added code ///
                                            //File.SetAttributes(location + f.Name, FileAttributes.Hidden);

                                        }
                                    }
                                    else
                                    {
                                        Int32 rst45 = 0;
                                        // string filename1 = f.Name;
                                        //DocId = clsDocument.InsertDocumentMaster(DocTypeId, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), filename1 , DocDesc, PartyId, "", 0, Convert.ToInt32(Session["EmployeeId"].ToString()));
                                        if (dat != "")
                                        {
                                            if (prtid == 0)
                                            {
                                                rst45 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(dat), extstr);
                                                imagefo(filename1, rst45);
                                            }
                                            else if (prtid > 0)
                                            {
                                                rst45 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(dat), extstr);
                                                imagefo(filename1, rst45);
                                            }
                                        }
                                        else
                                        {
                                            if (prtid == 0)
                                            {
                                                rst45 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(System.DateTime.Now.ToString()), extstr);
                                                imagefo(filename1, rst45);
                                            }
                                            else if (prtid > 0)
                                            {
                                                rst45 = clsDocument.InsertDocumentMaster(folderid, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, prtid, refst, Convert.ToDecimal(amt), 1, Convert.ToDateTime(System.DateTime.Now.ToString()), extstr);
                                                imagefo(filename1, rst45);
                                            }
                                        }
                                        //Int32 rst = clsDocument.InsertDocumentMaster(DocumentTypeId, 2, Convert.ToDateTime(System.DateTime.Now.ToString()), filename1.ToString(), doc_title, doc_email_desc, partyid, refst,amt, 1);
                                        // *** ADDed Code  ** //
                                        //docautoapprove = true;
                                        if (rst45 > 0)
                                        {
                                            if (docautoapprove == true)
                                            {
                                                //string docaprv = "select max(DocumentId) from DocumentMaster";
                                                DataTable dtdcap = new DataTable();
                                                dtdcap = clsDocument.SelectMaxDocumentIdfromDocumentMaster();
                                                bool dcaprv = docautoapprove;
                                                //Int32 indcapr = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), Convert.ToInt32(dtdcap.Rows[0]["DocumentId"].ToString()));
                                                bool indc = clsDocument.insertDocumentProcessingnew(Convert.ToInt32(Session["EmployeeId"]), Convert.ToInt32(dtdcap.Rows[0]["DocumentId"].ToString()), docautoapprove);

                                            }
                                        }
                                    }
                                }

                            }


                        }
                    }
                }

            }

        }


        objPOP3.Close();

        return true;
    }

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  